<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Week 11: Detecting Adaptation • LandGenCourse</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/cerulean/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Week 11: Detecting Adaptation">
<meta property="og:description" content="LandGenCourse">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--><!-- Global site tag (gtag.js) - Google Analytics --><script async src="https://www.googletagmanager.com/gtag/js?id=UA-168837293-1"></script><script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-168837293-1');
</script>
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">LandGenCourse</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">1.4.5</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/Week0_BasicR.html">Week 0: Intro to R Programming</a>
    </li>
    <li>
      <a href="../articles/Week0_Graphics.html">Week 0: R Graphics</a>
    </li>
    <li>
      <a href="../articles/Week1_vignette.html">Week 1: Importing Genetic Data</a>
    </li>
    <li>
      <a href="../articles/Week2_vignette.html">Week 2: Spatial Data</a>
    </li>
    <li>
      <a href="../articles/Week2_bonus_vignette.html">Week 2: Bonus Material</a>
    </li>
    <li>
      <a href="../articles/Week3_vignette.html">Week 3: Genetic Diversity</a>
    </li>
    <li>
      <a href="../articles/Week4_vignette.html">Week 4: Metapopulation Genetics</a>
    </li>
    <li>
      <a href="../articles/Week5_vignette.html">Week 5: Spatial Statistics</a>
    </li>
    <li>
      <a href="../articles/Week6_vignette.html">Week 6: Quantitative Genetics</a>
    </li>
    <li>
      <a href="../articles/Week7_vignette.html">Week 7: Spatial Linear Models</a>
    </li>
    <li>
      <a href="../articles/Week8_vignette.html">Week 8: Simulation</a>
    </li>
    <li>
      <a href="../articles/Week8_bonus_vignette.html">Week 8: Bonus Material</a>
    </li>
    <li>
      <a href="../articles/Week9_vignette.html">Week 9: Population Structure</a>
    </li>
    <li>
      <a href="../articles/Week10_vignette.html">Week 10: Landscape Resistance</a>
    </li>
    <li>
      <a href="../articles/Week11_vignette.html">Week 11: Detecting Adaptation</a>
    </li>
    <li>
      <a href="../articles/Week12_vignette.html">Week 12: Model Selection</a>
    </li>
    <li>
      <a href="../articles/Week13_vignette.html">Week 13: Gravity Models</a>
    </li>
    <li>
      <a href="../articles/Week14_vignette.html">Week 14: Contemporary Gene Flow</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Tutorials
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../tutorials/00-Intro_RStudio.html">Introduction to RStudio</a>
    </li>
    <li>
      <a href="../tutorials/00-Intro_LandGenCourse.html">Introduction to the LandGenCourse package</a>
    </li>
    <li>
      <a href="../tutorials/00-Intro_RNotebooks.html">Introduction to R Notebooks</a>
    </li>
    <li>
      <a href="../tutorials/00-Version_Control.html">Version Control 101</a>
    </li>
    <li>
      <a href="../tutorials/01-Genetic_Data.html">Week 1 Getting Landscape Genetic Data into R</a>
    </li>
    <li>
      <a href="../tutorials/02-Spatial_Data.html">Week 2 Land Cover Analysis in R</a>
    </li>
    <li>
      <a href="../tutorials/03-Genetic_Diversity.html">Week 3 Genetic Diversity (Part 1)</a>
    </li>
    <li>
      <a href="../tutorials/03-Genetic_Diversity_Part2.html">Week 3 Genetic Diversity (Part 2)</a>
    </li>
    <li>
      <a href="../tutorials/04-Metapop_Genetics.html">Week 4 Metapopulation Genetics (Part 1)</a>
    </li>
    <li>
      <a href="../tutorials/04-Metapop_Genetics_Part2.html">Week 4 Metapopulation Genetics (Part 2)</a>
    </li>
    <li>
      <a href="../tutorials/05-Spatial_Stats.html">Week 5 Spatial Statistics</a>
    </li>
    <li>
      <a href="../tutorials/06-Quantitative_Genetics.html">Week 6 Quantitative Genetics (Part 1)</a>
    </li>
    <li>
      <a href="../tutorials/06-Quantitative_Genetics_Part2.html">Week 6 Quantitative Genetics (Part 2)</a>
    </li>
    <li>
      <a href="../tutorials/07-Spatial_Models.html">Week 7 Spatial Linear Models (Part 1)</a>
    </li>
    <li>
      <a href="../tutorials/07-Spatial_Models_Part2.html">Week 7 Spatial Linear Models (Part 2)</a>
    </li>
    <li>
      <a href="../tutorials/08-Modeling.html">Week 8 Simulation Experiments in R (Part 1)</a>
    </li>
    <li>
      <a href="../tutorials/08-Modeling_Part2.html">Week 8 Simulation Experiments in R (Part 2)</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right"></ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Week 11: Detecting Adaptation</h1>
                        <h4 class="author">Brenna R. Forester</h4>
            
            <h4 class="date">2020-06-08</h4>
      
      
      <div class="hidden name"><code>Week11_vignette.Rmd</code></div>

    </div>

    
    
<div id="overview-of-worked-example" class="section level2">
<h2 class="hasAnchor">
<a href="#overview-of-worked-example" class="anchor"></a>1. Overview of Worked Example</h2>
<div id="a-goals" class="section level3">
<h3 class="hasAnchor">
<a href="#a-goals" class="anchor"></a>a) Goals</h3>
<p>This worked example will illustrate the use of two types of genotype-environment association analyses, one univariate and one multivariate. Specifically, you will learn:</p>
<ul>
<li>Strategies for screening and preparing predictor variables for different GEA analyses;</li>
<li>How to run and interpret a Latent Factor Mixed Model (LFMM);</li>
<li>One option for post-processing LFMM results using the genomic inflation factor (GIF) and false discovery rate (FDR) to correct for multiple tests;</li>
<li>How to run and interpret Redundancy Analysis for GEA.</li>
</ul>
</div>
<div id="b-data-set" class="section level3">
<h3 class="hasAnchor">
<a href="#b-data-set" class="anchor"></a>b) Data set</h3>
<p>We will reanalyze genomic data from 94 North American gray wolves (<em>Canis lupus</em>) sampled across Canada and Alaska (Schweizer et al., 2016). We are interested in understanding how wolves may be locally adapted to environmental conditions across their North American range.</p>
<p>The genetic data are individual-based, and are input as allele counts (i.e. 0/1/2) for each locus. In the interest of computational efficiency, we will use a randomly sampled subset of 10,000 single nucleotide polymorphism (SNP) markers from the full data set (which contains 42,587 SNPs).</p>
<p>In addition, we have eight environmental predictors that are ecologically relevant and are not highly correlated (|r| &lt; 0.7). This is a reduced set of predictors from the 12 originally included by Schweizer et al. (2016).</p>
</div>
<div id="c-required-r-libraries" class="section level3">
<h3 class="hasAnchor">
<a href="#c-required-r-libraries" class="anchor"></a>c) Required R libraries</h3>
<p>You may need to install packages ‘qvalue’ from BioClim and ‘lfmm’ from GitHub:</p>
<div class="sourceCode" id="cb1"><html><body><pre class="r"><span class="kw">if</span>(!<span class="fu"><a href="https://rdrr.io/r/base/ns-load.html">requireNamespace</a></span>(<span class="st">"qvalue"</span>, <span class="kw">quietly</span> <span class="kw">=</span> <span class="fl">TRUE</span>)) {
  <span class="kw">if</span> (!<span class="fu"><a href="https://rdrr.io/r/base/ns-load.html">requireNamespace</a></span>(<span class="st">"BiocManager"</span>, <span class="kw">quietly</span> <span class="kw">=</span> <span class="fl">TRUE</span>))
    <span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html">install.packages</a></span>(<span class="st">"BiocManager"</span>)
  <span class="kw pkg">BiocManager</span><span class="kw ns">::</span><span class="fu"><a href="https://rdrr.io/pkg/BiocManager/man/install.html">install</a></span>(<span class="st">"qvalue"</span>)
}
<span class="kw">if</span>(!<span class="fu"><a href="https://rdrr.io/r/base/ns-load.html">requireNamespace</a></span>(<span class="st">"lfmm"</span>, <span class="kw">quietly</span> <span class="kw">=</span> <span class="fl">TRUE</span>)) {
  <span class="kw pkg">remotes</span><span class="kw ns">::</span><span class="fu"><a href="https://remotes.r-lib.org/reference/install_github.html">install_github</a></span>(<span class="st">"bcm-uga/lfmm"</span>)
}</pre></body></html></div>
<div class="sourceCode" id="cb2"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="no">LandGenCourse</span>)
<span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="no">vegan</span>)    <span class="co"># Used to run PCA &amp; RDA</span>
<span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="no">lfmm</span>)     <span class="co"># Used to run LFMM</span>
<span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="no">qvalue</span>)   <span class="co"># Used to post-process LFMM output</span></pre></body></html></div>
</div>
</div>
<div id="import-and-prepare-the-data" class="section level2">
<h2 class="hasAnchor">
<a href="#import-and-prepare-the-data" class="anchor"></a>2. Import and prepare the data</h2>
<div id="a-import-the-genetic-data" class="section level3">
<h3 class="hasAnchor">
<a href="#a-import-the-genetic-data" class="anchor"></a>a) Import the genetic data</h3>
<p>I downloaded these data from the Schweizer et al. (2016) <a href="http://datadryad.org/resource/doi:10.5061/dryad.c9b25">Dryad repository</a> and converted them from .tped to .raw format using plink (Purcell et al., 2007). Then, using the R package <code>adegenet</code> (Jombart 2008), I read in the .raw data and extracted the matrix of 94 individuals x 42,587 SNPs. Finally, I randomly sampled 10,000 columns (SNPs) from the full data set, which is what we will analyze in this worked example.</p>
<p>The full data in .raw format are available in the Supplemental Information for Forester et al. (2018). If you want to analyze the full data set, use the <code>read.PLINK</code> call from <code>adegenet</code> to read the data into R.</p>
<div class="sourceCode" id="cb3"><html><body><pre class="r"><span class="no">gen</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/utils/read.table.html">read.csv</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/system.file.html">system.file</a></span>(<span class="st">"extdata"</span>, <span class="st">"wolf_geno_samp_10000.csv"</span>, <span class="kw">package</span> <span class="kw">=</span> <span class="st">"LandGenCourse"</span>), <span class="kw">row.names</span><span class="kw">=</span><span class="fl">1</span>)
<span class="fu"><a href="https://rdrr.io/r/base/dim.html">dim</a></span>(<span class="no">gen</span>)</pre></body></html></div>
<pre><code>## [1]    94 10000</code></pre>
<p>We have 94 individuals (rows) genotyped at 10,000 SNPs (columns).</p>
<p>Both LFMM and RDA require complete data frames (i.e., no missing genetic data). For this example, we’ll use a simple approach to imputing missing genotype values: we will impute using the most common genotype at each SNP across all individuals.</p>
<div class="sourceCode" id="cb5"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/NA.html">is.na</a></span>(<span class="no">gen</span>)) <span class="co"># 27,987 NAs in the matrix (~3% missing data)</span></pre></body></html></div>
<pre><code>## [1] 27987</code></pre>
<div class="sourceCode" id="cb7"><html><body><pre class="r"><span class="no">gen.imp</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/apply.html">apply</a></span>(<span class="no">gen</span>, <span class="fl">2</span>, <span class="kw">function</span>(<span class="no">x</span>) <span class="fu"><a href="https://rdrr.io/r/base/replace.html">replace</a></span>(<span class="no">x</span>, <span class="fu"><a href="https://rdrr.io/r/base/NA.html">is.na</a></span>(<span class="no">x</span>), <span class="fu"><a href="https://rdrr.io/r/base/numeric.html">as.numeric</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/names.html">names</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/which.min.html">which.max</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/table.html">table</a></span>(<span class="no">x</span>))))))
<span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/NA.html">is.na</a></span>(<span class="no">gen.imp</span>)) <span class="co"># No NAs</span></pre></body></html></div>
<pre><code>## [1] 0</code></pre>
<p>We could also use this imputation approach within ecotypes (rather than across all individuals). Other promising imputation methods for species lacking a reference genome include: using ancestry values from <code>snmf</code> in the <code>LEA</code> package (Frichot &amp; Francois 2015), and the program LinkImpute (Money et al., 2015).</p>
</div>
<div id="b-import-the-environmental-data" class="section level3">
<h3 class="hasAnchor">
<a href="#b-import-the-environmental-data" class="anchor"></a>b) Import the environmental data</h3>
<p>The original data set comes with 12 predictors, but many of them are highly correlated, which can cause problems for regression-based methods like LFMM and RDA. I conducted variable reduction using the |0.7| “rule of thumb” (Dormann et al., 2013) and an ecological interpretation of the relevance of possible predictors. Can you double check the correlations among the variables?</p>
<p>For more information on the rationale for variable reduction, see the full <a href="http://popgen.nescent.org/2018-03-27_RDA_GEA.html">RDA vignette</a>.</p>
<div class="sourceCode" id="cb9"><html><body><pre class="r"><span class="no">env</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/utils/read.table.html">read.csv</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/system.file.html">system.file</a></span>(<span class="st">"extdata"</span>, <span class="st">"EnvironmentalData_8pred.csv"</span>, <span class="kw">package</span> <span class="kw">=</span> <span class="st">"LandGenCourse"</span>))
<span class="fu"><a href="https://rdrr.io/r/utils/str.html">str</a></span>(<span class="no">env</span>) <span class="co"># Look at the structure of the data frame</span></pre></body></html></div>
<pre><code>## 'data.frame':    94 obs. of  12 variables:
##  $ individual        : Factor w/ 94 levels "11226.CEL","11228.CEL",..: 1 2 3 4 5 6 7 8 9 10 ...
##  $ ecotype           : Factor w/ 6 levels "Pop_1_WestForest",..: 2 6 6 6 2 2 2 2 2 2 ...
##  $ long              : num  -94.5 -88.1 -72 -72 -114.8 ...
##  $ lat               : num  49.8 49.1 58.8 58.6 60.6 ...
##  $ ann_mean_temp     : int  23 15 -69 -66 -34 -37 -35 -47 -46 -20 ...
##  $ mean_diurnal_range: int  97 115 75 76 102 114 112 99 109 115 ...
##  $ temp_seasonality  : int  13047 11408 11831 11867 14259 14806 15176 15844 15312 14099 ...
##  $ ann_precip        : int  610 784 483 477 335 319 372 339 284 375 ...
##  $ precip_seasonality: int  47 29 39 40 39 34 43 48 36 46 ...
##  $ ndvi              : int  7403 8222 6450 6141 7595 7518 7472 8157 7348 6616 ...
##  $ elev              : int  349 234 264 200 194 219 280 154 190 222 ...
##  $ percent_tree_cover: int  36 51 5 9 26 48 47 61 61 47 ...</code></pre>
<div class="sourceCode" id="cb11"><html><body><pre class="r"><span class="no">env</span>$<span class="no">individual</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/character.html">as.character</a></span>(<span class="no">env</span>$<span class="no">individual</span>) <span class="co"># Make individual names characters (not factors)</span>

<span class="co"># Confirm that genotypes and environmental data are in the same order</span>
<span class="fu"><a href="https://rdrr.io/r/base/identical.html">identical</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/colnames.html">rownames</a></span>(<span class="no">gen.imp</span>), <span class="no">env</span>[,<span class="fl">1</span>])</pre></body></html></div>
<pre><code>## [1] TRUE</code></pre>
<p>Now we’ll subset just the environmental predictors &amp; shorten their names:</p>
<div class="sourceCode" id="cb13"><html><body><pre class="r"><span class="no">pred</span> <span class="kw">&lt;-</span> <span class="no">env</span>[,<span class="fl">5</span>:<span class="fl">12</span>]
<span class="fu"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span>(<span class="no">pred</span>) <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"AMT"</span>,<span class="st">"MDR"</span>,<span class="st">"sdT"</span>,<span class="st">"AP"</span>,<span class="st">"cvP"</span>,<span class="st">"NDVI"</span>,<span class="st">"Elev"</span>,<span class="st">"Tree"</span>)</pre></body></html></div>
<p>For the univariate LFMM test, we could run a separate set of tests for each of these eight predictors; this would be a test for each of the 10,000 SNPs with each predictor = 80,000 tests (!). Instead, for LFMM, we’ll perform a PCA on the environmental predictors and use the first principal component (PC) as a synthetic predictor. This will reduce our ability to interpret the output, since the PC predictor will be a linear combination of the original eight variables, but it will reduce the number of corrections needed for multiple tests. Your decision of how to handle multiple predictors for a univarate GEA test will depend on the study goals and characteristics of the data set.</p>
<p>There are many ways to run PCA in R; we’ll use the <code>rda</code> function in <code>vegan</code> (Oksanen et al., 2016). We’ll center and scale the predictors (<code>scale=T</code>), since they’re in different units. We’ll then determine the proportion of the environmental variance explained by each PC axis &amp; investigate how the original predictors correlate with the first PC axis.</p>
<div class="sourceCode" id="cb14"><html><body><pre class="r"><span class="no">pred.pca</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/vegan/man/cca.html">rda</a></span>(<span class="no">pred</span>, <span class="kw">scale</span><span class="kw">=</span><span class="no">T</span>)
<span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span>(<span class="no">pred.pca</span>)$<span class="no">cont</span></pre></body></html></div>
<pre><code>## $importance
## Importance of components:
##                         PC1    PC2    PC3     PC4     PC5     PC6     PC7
## Eigenvalue            3.224 1.8354 1.1258 0.70269 0.48967 0.34983 0.21138
## Proportion Explained  0.403 0.2294 0.1407 0.08784 0.06121 0.04373 0.02642
## Cumulative Proportion 0.403 0.6324 0.7731 0.86096 0.92217 0.96590 0.99232
##                            PC8
## Eigenvalue            0.061457
## Proportion Explained  0.007682
## Cumulative Proportion 1.000000</code></pre>
<div class="sourceCode" id="cb16"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/stats/screeplot.html">screeplot</a></span>(<span class="no">pred.pca</span>, <span class="kw">main</span> <span class="kw">=</span> <span class="st">"Screeplot: Eigenvalues of Wolf Predictor Variables"</span>)</pre></body></html></div>
<p><img src="Week11_vignette_files/figure-html/unnamed-chunk-1-1.png" width="576"></p>
<div class="sourceCode" id="cb17"><html><body><pre class="r"><span class="co"># correlations between the PC axis and predictors:</span>
<span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span>(<span class="fu"><a href="https://rdrr.io/pkg/vegan/man/scores.html">scores</a></span>(<span class="no">pred.pca</span>, <span class="kw">choices</span><span class="kw">=</span><span class="fl">1</span>:<span class="fl">8</span>, <span class="kw">display</span><span class="kw">=</span><span class="st">"species"</span>, <span class="kw">scaling</span><span class="kw">=</span><span class="fl">0</span>), <span class="kw">digits</span><span class="kw">=</span><span class="fl">3</span>)</pre></body></html></div>
<pre><code>##         PC1    PC2    PC3    PC4    PC5    PC6    PC7    PC8
## AMT  -0.519  0.029 -0.040  0.198 -0.091 -0.297 -0.436 -0.634
## MDR  -0.315 -0.531  0.258 -0.051 -0.190 -0.259 -0.332  0.579
## sdT   0.193 -0.586 -0.225 -0.203  0.340  0.464 -0.372 -0.244
## AP   -0.353  0.468 -0.071  0.212  0.228  0.516 -0.387  0.372
## cvP   0.319 -0.219  0.070  0.888 -0.199  0.130 -0.033 -0.007
## NDVI -0.404 -0.253 -0.220  0.281  0.618 -0.161  0.481  0.077
## Elev -0.150 -0.054  0.876 -0.029  0.174  0.301  0.178 -0.231
## Tree -0.426 -0.200 -0.233 -0.064 -0.580  0.480  0.385 -0.071
## attr(,"const")
## [1] 5.222678</code></pre>
<p>40% of the variance in the predictors is explained by the first PC axis, and 23% by the second axis. We could follow up with an LFMM model using the second axis as a predictor, if we wanted. The strongest correlations with PC1 are annual mean temperature (AMT), tree cover (Tree), NDVI, and annual precipitation (AP).</p>
<p>We’ll store our synthetic PC axis predictor as <code>pred.PC1</code> for use in LFMM.</p>
<div class="sourceCode" id="cb19"><html><body><pre class="r"><span class="no">pred.PC1</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/vegan/man/scores.html">scores</a></span>(<span class="no">pred.pca</span>, <span class="kw">choices</span><span class="kw">=</span><span class="fl">1</span>, <span class="kw">display</span><span class="kw">=</span><span class="st">"sites"</span>, <span class="kw">scaling</span><span class="kw">=</span><span class="fl">0</span>)</pre></body></html></div>
</div>
</div>
<div id="latent-factor-mixed-models-lfmm-a-univariate-gea" class="section level2">
<h2 class="hasAnchor">
<a href="#latent-factor-mixed-models-lfmm-a-univariate-gea" class="anchor"></a>3. Latent Factor Mixed Models (LFMM): a univariate GEA</h2>
<p>LFMM is a univariate test, which means that it builds a model for each SNP and each predictor variable. In this case, we will run 10,000 SNPs x 1 synthetic predictor = 10,000 separate LFMM tests.</p>
<div id="a-determine-k" class="section level3">
<h3 class="hasAnchor">
<a href="#a-determine-k" class="anchor"></a>a) Determine K</h3>
<p>LFMM requires an estimate of the number of populations in the data (K). To determine the most likely value of K, we’ll use PCA, noting that there are many different approaches for determining “K” from genetic data (more below). It is also reasonable to run LFMM with different values of K, if there is uncertainty.</p>
<p>We’ll use a broken stick criterion to determine K. The broken stick stopping rule states that principal components should be retained as long as observed eigenvalues are higher than corresponding random broken stick components.</p>
<p>For example, if we reran the environmental PCA screeplot from above with a broken stick criterion:</p>
<div class="sourceCode" id="cb20"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/stats/screeplot.html">screeplot</a></span>(<span class="no">pred.pca</span>, <span class="kw">main</span> <span class="kw">=</span> <span class="st">"Screeplot of Wolf Predictor Variables with Broken Stick"</span>, <span class="kw">bstick</span><span class="kw">=</span><span class="fl">TRUE</span>, <span class="kw">type</span><span class="kw">=</span><span class="st">"barplot"</span>)</pre></body></html></div>
<p><img src="Week11_vignette_files/figure-html/unnamed-chunk-2-1.png" width="576"></p>
<p>You can see that PC1 and PC2 explain more than the random broken stick components, while PC3 + do not. If this were genomic data, and we were determining a value of K using this approach, we’d set K = 3.</p>
<p>Now let’s run a PCA with the genommic data and plot the eigenvalues with the broken stick criterion:</p>
<div class="sourceCode" id="cb21"><html><body><pre class="r"><span class="no">gen.pca</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/vegan/man/cca.html">rda</a></span>(<span class="no">gen.imp</span>, <span class="kw">scale</span><span class="kw">=</span><span class="no">T</span>)
<span class="fu"><a href="https://rdrr.io/r/stats/screeplot.html">screeplot</a></span>(<span class="no">gen.pca</span>, <span class="kw">main</span> <span class="kw">=</span> <span class="st">"Screeplot of Genetic Data with Broken Stick"</span>, <span class="kw">bstick</span><span class="kw">=</span><span class="fl">TRUE</span>, <span class="kw">type</span><span class="kw">=</span><span class="st">"barplot"</span>)</pre></body></html></div>
<p><img src="Week11_vignette_files/figure-html/unnamed-chunk-3-1.png" width="576"></p>
<p>For the genomic data, we can see that none of the PCs have eigenvalues greater than random (greater than the broken stick values in red). This effectively means that K=1 for the wolf data set, based on a PCA assessment. [Note that we see a similar result using the full genomic data set of 42K SNPs]. This does not mean there isn’t genetic structure in the data; it just means the structure isn’t particularly strong and/or easily partitioned into discrete groupings.</p>
<p>In the original paper, the authors determined K using Structure. They found support for multiple K values between 3 and 7. The wolf data show an isolation by distance signature, which can confound methods used to identify K and contribute to uncertainty. How do you suspect that differences in K (say K=1 vs. K=3) for LFMM might influence the GEA results?</p>
<p>For now, we’ll use K=3 following the original manuscript. It would be interesting to compare K=1 to these results, if you have time. Note that with K=1, LFMM is essentially running a simple linear regression (i.e., no latent factors).</p>
<div class="sourceCode" id="cb22"><html><body><pre class="r"><span class="no">K</span> <span class="kw">&lt;-</span> <span class="fl">3</span></pre></body></html></div>
</div>
<div id="b-run-lfmm" class="section level3">
<h3 class="hasAnchor">
<a href="#b-run-lfmm" class="anchor"></a>b) Run LFMM</h3>
<p>LFMM is a regression model that includes unobserved variables (latent factors, set with “K”) that correct the model for confounding effects, such as population structure. The latent factors are estimated simultaneously with the environmental and response variables, which can help improve power when environment and demography are correlated.</p>
<p>The previous version of LFMM (v1.5, implemented in the LEA package) uses an MCMC (Markov chain Monte Carlo) algorithm to identify GEAs while correcting for confounding. MCMC made it (very!) time-intensive for large data sets. LFMM v.2 computes LFMMs for GEA using a least-squares estimation method that is substantially faster than v1.5 (Caye et al., 2019). There are two penalty approaches: ridge and lasso. We’ll use ridge today (see <code><a href="https://rdrr.io/pkg/lfmm/man/lfmm_ridge.html">?lfmm_ridge</a></code>); see Jumentier et al. (2020) for more information on the ridge vs. lasso penalties.</p>
<div class="sourceCode" id="cb23"><html><body><pre class="r"><span class="no">wolf.lfmm</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/lfmm/man/lfmm_ridge.html">lfmm_ridge</a></span>(<span class="kw">Y</span><span class="kw">=</span><span class="no">gen.imp</span>, <span class="kw">X</span><span class="kw">=</span><span class="no">pred.PC1</span>, <span class="kw">K</span><span class="kw">=</span><span class="no">K</span>) <span class="co"># change K as you see fit</span></pre></body></html></div>
<p>That was fast! As you’ll see, post-processing these results is what takes up most of our time and effort…</p>
</div>
<div id="c-identify-lfmm-candidates-using-false-discovery-rate" class="section level3">
<h3 class="hasAnchor">
<a href="#c-identify-lfmm-candidates-using-false-discovery-rate" class="anchor"></a>c) Identify LFMM candidates using False Discovery Rate</h3>
<p>Next, we post-process the model output. We will move fast here; I strongly recommend reading “Controlling false discoveries in genome scans for selection” (Francois et al., 2016) if you will be running these post-processing steps on your own data! Decisions made here can dramatically impact the candidate markers you identify.</p>
<p>The steps for post-processing are:</p>
<ol style="list-style-type: decimal">
<li>Look at the genomic inflation factor (GIF), which gives us a sense for how well the model has accounted for confounding factors in the data.</li>
<li>Plot the p-values to see how application of the GIF influences the p-value distribution.</li>
<li>Modify the GIF (if needed) and re-plot the p-values to identify the best possible fit to the “ideal” p-value distribution.</li>
<li>Apply a False Discovery Rate control method to the p-values by converting to q-values.</li>
<li>Identify candidates as those below a given FDR threshold.</li>
</ol>
<p>The False Discovery Rate is the expected proportion of false positives among the list of positive tests (see Storey and Tibshirani, 2003).</p>
<p><em>An essential point to understand here is that the FDR is predicated on the “ideal” p-value distribution</em> (flat with a peak at 0, see Francois et al. 2016).</p>
<p>For example, an FDR threshold of 0.10 applied to a dataset with an ideal p-value distribution would produce 10% false positives (aka false discoveries) among the set of positive tests. However, if the p-value distribution deviates from the ideal, this same FDR threshold of 0.10 would produce more or fewer false discoveries among the set of postive tests, depending on the skew in the p-value distribution.</p>
<p>So remember: <em>having an actual FDR that is in accordance with the nominal threshold you set is completely dependent on the p-values used.</em></p>
<p>The lfmm package has a nice built-in function to calculate test statistics for the predictor(s), see <code><a href="https://rdrr.io/pkg/lfmm/man/lfmm_test.html">?lfmm_test</a></code>:</p>
<div class="sourceCode" id="cb24"><html><body><pre class="r"><span class="no">wolf.pv</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/lfmm/man/lfmm_test.html">lfmm_test</a></span>(<span class="kw">Y</span><span class="kw">=</span><span class="no">gen.imp</span>, <span class="kw">X</span><span class="kw">=</span><span class="no">pred.PC1</span>, <span class="kw">lfmm</span><span class="kw">=</span><span class="no">wolf.lfmm</span>, <span class="kw">calibrate</span><span class="kw">=</span><span class="st">"gif"</span>)

<span class="fu"><a href="https://rdrr.io/r/base/names.html">names</a></span>(<span class="no">wolf.pv</span>) <span class="co"># this object includes raw z-scores and p-values, as well as GIF-calibrated scores and p-values</span></pre></body></html></div>
<pre><code>## [1] "B"                 "epsilon.sigma2"    "B.sigma2"         
## [4] "score"             "pvalue"            "gif"              
## [7] "calibrated.score2" "calibrated.pvalue"</code></pre>
<p>Let’s look at the genomic inflation factor (GIF):</p>
<div class="sourceCode" id="cb26"><html><body><pre class="r"><span class="no">wolf.pv</span>$<span class="no">gif</span></pre></body></html></div>
<pre><code>##      PC1 
## 2.772992</code></pre>
<p>An appropriately calibrated set of tests will have a GIF of around 1. The elevated GIF for our tests indicates that the results may be overly liberal in identifying candidate SNPs. If the GIF is less than one, the test may be too conservative.</p>
<p>NOTE: Changing the value of K influences the GIF, so additional tests using the “best” value of K +/- 1 may be needed in some cases. See Francois et al. (2016) for more details.</p>
<p>Let’s look at how application of the GIF to the p-values impacts the p-value distribution:</p>
<div class="sourceCode" id="cb28"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/graphics/hist.html">hist</a></span>(<span class="no">wolf.pv</span>$<span class="no">pvalue</span>[,<span class="fl">1</span>], <span class="kw">main</span><span class="kw">=</span><span class="st">"Unadjusted p-values"</span>)
<span class="fu"><a href="https://rdrr.io/r/graphics/hist.html">hist</a></span>(<span class="no">wolf.pv</span>$<span class="no">calibrated.pvalue</span>[,<span class="fl">1</span>], <span class="kw">main</span><span class="kw">=</span><span class="st">"GIF-adjusted p-values"</span>)</pre></body></html></div>
<p><img src="Week11_vignette_files/figure-html/unnamed-chunk-7-1.png" width="480"><img src="Week11_vignette_files/figure-html/unnamed-chunk-7-2.png" width="480"></p>
<p>We want to see a relatively flat histogram (most loci not under selection) with a peak near zero, indicating candidate adaptive markers. We see a very large peak with the unadjusted p-values, and a much smaller peak with the GIF-adjusted p-values (note differences in the scale of the y-axis).</p>
<p>Note that you can choose a different GIF and readjust the p-values to get a “better” histogram distribution (that is, a distribution that conforms best with what is expected under a well-calibrated set of models, see Francois et al, 2016). This process is subjective and can be difficult with empirical data sets, especially those with an IBD signature, such as these wolf data. Remember, you can also change the value of K in your lfmm models and see how this impacts the GIF.</p>
<p>Below I’ll show you how to manually adjust the GIF correction factor:</p>
<div class="sourceCode" id="cb29"><html><body><pre class="r"><span class="co"># Let's change the GIF and readjust the p-values:</span>
<span class="no">zscore</span> <span class="kw">&lt;-</span> <span class="no">wolf.pv</span>$<span class="no">score</span>[,<span class="fl">1</span>]   <span class="co"># zscores for first predictor, we only have one in our case...</span>
(<span class="no">gif</span> <span class="kw">&lt;-</span> <span class="no">wolf.pv</span>$<span class="no">gif</span>[<span class="fl">1</span>])       <span class="co"># default GIF for this predictor</span></pre></body></html></div>
<pre><code>##      PC1 
## 2.772992</code></pre>
<div class="sourceCode" id="cb31"><html><body><pre class="r"><span class="no">new.gif1</span> <span class="kw">&lt;-</span> <span class="fl">2.0</span>               <span class="co"># choose your new GIF</span>

<span class="co"># Manual adjustment of the p-values:</span>
<span class="no">adj.pv1</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Chisquare.html">pchisq</a></span>(<span class="no">zscore</span>^<span class="fl">2</span>/<span class="no">new.gif1</span>, <span class="kw">df</span><span class="kw">=</span><span class="fl">1</span>, <span class="kw">lower</span> <span class="kw">=</span> <span class="fl">FALSE</span>)</pre></body></html></div>
<p>Plot the p-value histograms:</p>
<div class="sourceCode" id="cb32"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/graphics/hist.html">hist</a></span>(<span class="no">wolf.pv</span>$<span class="no">pvalue</span>[,<span class="fl">1</span>], <span class="kw">main</span><span class="kw">=</span><span class="st">"Unadjusted p-values"</span>)
<span class="fu"><a href="https://rdrr.io/r/graphics/hist.html">hist</a></span>(<span class="no">wolf.pv</span>$<span class="no">calibrated.pvalue</span>[,<span class="fl">1</span>], <span class="kw">main</span><span class="kw">=</span><span class="st">"GIF-adjusted p-values (GIF=2.8)"</span>)
<span class="fu"><a href="https://rdrr.io/r/graphics/hist.html">hist</a></span>(<span class="no">adj.pv1</span>, <span class="kw">main</span><span class="kw">=</span><span class="st">"REadjusted p-values (GIF=2.0)"</span>)</pre></body></html></div>
<p><img src="Week11_vignette_files/figure-html/unnamed-chunk-9-1.png" width="480"><img src="Week11_vignette_files/figure-html/unnamed-chunk-9-2.png" width="480"><img src="Week11_vignette_files/figure-html/unnamed-chunk-9-3.png" width="480"></p>
<p>For now, we’ll stick with the default GIF calculated by the lfmm package, though it looks like the application of the GIF may be a bit conservative (e.g. it is compressing the peak at 0).</p>
<p>Finally, we convert the adjusted p-values to q-values. q-values provide a measure of each SNP’s significance, automatically taking into account the fact that thousands are simultaneously being tested. We can then use an FDR threshold to control the number of false positive detections (given that our p-value distribution is “well-behaved”).</p>
<div class="sourceCode" id="cb33"><html><body><pre class="r"><span class="no">wolf.qv</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/qvalue/man/qvalue.html">qvalue</a></span>(<span class="no">wolf.pv</span>$<span class="no">calibrated.pvalue</span>)$<span class="no">qvalues</span>

<span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/which.html">which</a></span>(<span class="no">wolf.qv</span> <span class="kw">&lt;</span> <span class="fl">0.1</span>)) <span class="co"># how many SNPs have an FDR &lt; 10%?</span></pre></body></html></div>
<pre><code>## [1] 12</code></pre>
<div class="sourceCode" id="cb35"><html><body><pre class="r">(<span class="no">wolf.FDR.1</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span>(<span class="no">gen.imp</span>)[<span class="fu"><a href="https://rdrr.io/r/base/which.html">which</a></span>(<span class="no">wolf.qv</span> <span class="kw">&lt;</span> <span class="fl">0.1</span>)]) <span class="co"># identify which SNPs these are</span></pre></body></html></div>
<pre><code>##  [1] "chr6.36999927"  "chr20.36354466" "chr17.54224832" "chr12.58928631"
##  [5] "chr12.55629962" "chr8.41109194"  "chr19.17640345" "chr8.63918041" 
##  [9] "chr20.10469494" "chr22.64010061" "chr5.25188969"  "chr9.36496633"</code></pre>
<p>Using K=3, the default GIF correction, and an FDR threshold of 0.10, we only detect 12 candidate SNPs under selection in response to our PC1 environmental predictor. What changes could we make to have a less conservative test?</p>
</div>
</div>
<div id="redundancy-analysis-rda-a-multivariate-gea" class="section level2">
<h2 class="hasAnchor">
<a href="#redundancy-analysis-rda-a-multivariate-gea" class="anchor"></a>4. Redundancy Analysis (RDA): a multivariate GEA</h2>
<div id="a-run-rda" class="section level3">
<h3 class="hasAnchor">
<a href="#a-run-rda" class="anchor"></a>a) Run RDA</h3>
<p>RDA is a multivariate ordination technique that can analyze many loci and environmental predictors simultaneously. For this reason, we can input all of the SNPs and environmental predictors at once, with no need to correct for multiple tests. RDA determines how groups of loci covary in response to the multivariate environment, and can better detect processes that result in weak, multilocus molecular signatures relative to univariate tests (Rellstab et al., 2015; Forester et al., 2018).</p>
<p>RDA can be used on both individual and population-based sampling designs. The distinction between the two may not be straightforward in all cases. A simple guideline would be to use an individual-based framework when you have individual coordinates for most of your samples, and the resolution of your environmental data would allow for a sampling of environmental conditions across the site/study area. For population-level data, you would input the genetic data as allele frequencies within demes.</p>
<p>The code to run the RDA is simple. However, I highly recommend reading Borcard et al. (2011) for details on the implementation and interpretation of RDA models and the objects created by <code>vegan</code>. RDA runs relatively quickly on most data sets, though you may need a high memory node on a cluster for very large data sets (i.e., millions of SNPs).</p>
<div class="sourceCode" id="cb37"><html><body><pre class="r"><span class="no">wolf.rda</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/vegan/man/cca.html">rda</a></span>(<span class="no">gen.imp</span> ~ <span class="no">.</span>, <span class="kw">data</span><span class="kw">=</span><span class="no">pred</span>, <span class="kw">scale</span><span class="kw">=</span><span class="no">T</span>)
<span class="no">wolf.rda</span></pre></body></html></div>
<pre><code>## Call: rda(formula = gen.imp ~ AMT + MDR + sdT + AP + cvP + NDVI + Elev
## + Tree, data = pred, scale = T)
## 
##                Inertia Proportion Rank
## Total         8307.000      1.000     
## Constrained   1113.488      0.134    8
## Unconstrained 7193.512      0.866   85
## Inertia is correlations 
## 
## Eigenvalues for constrained axes:
##   RDA1   RDA2   RDA3   RDA4   RDA5   RDA6   RDA7   RDA8 
## 281.19 216.87 179.53 110.84  89.78  87.15  75.93  72.20 
## 
## Eigenvalues for unconstrained axes:
##    PC1    PC2    PC3    PC4    PC5    PC6    PC7    PC8 
## 261.51 211.68 197.60 171.80 127.67 121.61 115.54 110.04 
## (Showing 8 of 85 unconstrained eigenvalues)</code></pre>
<p>First, note that we will have as many constrained (“RDA”) axes as we have predictors in the model. All residual variance is then modeled by PCA (the unconstrained “PC” axes). The proportion of the variance explained by the environmental predictors is given under the “Proportion” column for “Constrained”; this is equivalent to the R<sup>2</sup> of a multiple regression. Just like in multiple regression, this R<sup>2</sup> will be biased and should be adjusted based on the number of predictors. We can calculate the adjusted R<sup>2</sup> using:</p>
<div class="sourceCode" id="cb39"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/pkg/vegan/man/RsquareAdj.html">RsquareAdj</a></span>(<span class="no">wolf.rda</span>)</pre></body></html></div>
<pre><code>## $r.squared
## [1] 0.1340421
## 
## $adj.r.squared
## [1] 0.05254019</code></pre>
<p>Our constrained ordination explains about 5% of the variation; this low explanatory power is not surprising given that we expect that most of the SNPs in our dataset will not show a relationship with the environmental predictors (e.g., most SNPs will be neutral).</p>
<p>The eigenvalues for the constrained axes reflect the variance explained by each canonical axis:</p>
<div class="sourceCode" id="cb41"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span>(<span class="no">wolf.rda</span>)$<span class="no">concont</span></pre></body></html></div>
<pre><code>## $importance
## Importance of components:
##                           RDA1     RDA2     RDA3      RDA4     RDA5     RDA6
## Eigenvalue            281.1906 216.8651 179.5282 110.84337 89.78143 87.14904
## Proportion Explained    0.2525   0.1948   0.1612   0.09955  0.08063  0.07827
## Cumulative Proportion   0.2525   0.4473   0.6085   0.70807  0.78870  0.86697
##                           RDA7     RDA8
## Eigenvalue            75.92523 72.20485
## Proportion Explained   0.06819  0.06485
## Cumulative Proportion  0.93515  1.00000</code></pre>
<p>We can visualize this information using a screeplot of the canonical eigenvalues by calling <code>screeplot</code>:</p>
<div class="sourceCode" id="cb43"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/stats/screeplot.html">screeplot</a></span>(<span class="no">wolf.rda</span>)</pre></body></html></div>
<p><img src="Week11_vignette_files/figure-html/screeplot,%20-1.png" width="595.2"></p>
<p>Here, we can see that the first three constrained axes explain most of the variance. The screeplot provides an informal (and quick) way to determine how many constrained axes to include when we search for candidate SNPs (below). We could start by investigating RDA axes that explain the most variance (excluding those after the “drop off” point in the screeplot.)</p>
<p>You can run a formal test of statistical significance of each constrained axis using: <code><a href="https://rdrr.io/pkg/vegan/man/anova.cca.html">anova.cca(wolf.rda, by="axis")</a></code>. We can assess both the full model and each constrained axis using F-statistics (Legendre et al, 2010). The null hypothesis is that no linear relationship exists between the SNP data and the environmental predictors. See <code><a href="https://rdrr.io/pkg/vegan/man/anova.cca.html">?anova.cca</a></code> for more details and options. The screeplot and a formal test (by axis) are both reasonable approaches for determining which RDA axes to assess for candidate SNPs.</p>
<p>The permutation process to test the signficiance of each axis takes a while (up to a few hours on large data sets), so we’ll just use the screeplot for a first assessment. If we did run the formal test, we would find that the first three constrained axes are significant (p = 0.001); constrained axis 4 has a p-value of 0.080, while axes 5-8 have p-values &gt; 0.850. This corresponds with our evaluation of the screeplot, above.</p>
<p>Finally, <code>vegan</code> has a simple function for checking Variance Inflation Factors for the predictor variables used in the model. This helps identify redundant predictors:</p>
<div class="sourceCode" id="cb44"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/pkg/vegan/man/goodness.cca.html">vif.cca</a></span>(<span class="no">wolf.rda</span>)</pre></body></html></div>
<pre><code>##      AMT      MDR      sdT       AP      cvP     NDVI     Elev     Tree 
## 7.854243 6.495892 2.775059 4.051610 1.318631 2.285632 2.028377 2.260139</code></pre>
<p>All values are below 10, and most are below 5, which indicates that multicollinearity among these predictors shouldn’t be a problem (Zuur et al., 2010).</p>
<p>Let’s make a quick plot of the RDA output using the default plotting in <code>vegan</code>:</p>
<div class="sourceCode" id="cb46"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/graphics/plot.html">plot</a></span>(<span class="no">wolf.rda</span>, <span class="kw">scaling</span><span class="kw">=</span><span class="fl">3</span>)  <span class="co"># default is axes 1 and 2</span></pre></body></html></div>
<p><img src="Week11_vignette_files/figure-html/simple_plot-1.png" width="480"></p>
<p>Here, the SNPs are in red (in the center of each plot), and the individuals are the black circles. The blue vectors are the environmental predictors. The relative arrangement of these items in the ordination space reflects their relationship with the ordination axes, which are linear combinations of the predictor variables.</p>
<p>See the full <a href="http://popgen.nescent.org/2018-03-27_RDA_GEA.html">RDA vignette</a> for details on how to make more informative (and prettier!) RDA plots for this data set. For example, we could more clearly visualize the identified candidate loci in the ordination space and see how they are linked to the environmental predictors. We could also use RDA to investigate how wolf ecotypes (based on individual genotypes) are distributed in relation to the environmental predictors (Forester et al., 2018, Figures 9 &amp; 10).</p>
</div>
<div id="b-identify-rda-candidates" class="section level3">
<h3 class="hasAnchor">
<a href="#b-identify-rda-candidates" class="anchor"></a>b) Identify RDA candidates</h3>
<p>We’ll use the loadings of the SNPs (their location) in the ordination space to determine which SNPs are candidates for local adaptation. The SNP loadings are stored as <code>species</code> in the RDA object. We’ll extract the SNP loadings from the first three constrained axes, based on our assessment of the screeplot above.</p>
<div class="sourceCode" id="cb47"><html><body><pre class="r"><span class="no">load.rda</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span>(<span class="no">wolf.rda</span>)$<span class="no">species</span>[,<span class="fl">1</span>:<span class="fl">3</span>]</pre></body></html></div>
<p>If we look at histograms of the loadings on each RDA axis, we can see their (relatively normal) distribution. SNPs loading at the center of the distribution are not showing a relationship with the environmental predictors; those loading in the tails are, and are more likely to be under selection as a function of those predictors (or some other predictor correlated with them).</p>
<div class="sourceCode" id="cb48"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/graphics/hist.html">hist</a></span>(<span class="no">load.rda</span>[,<span class="fl">1</span>], <span class="kw">main</span><span class="kw">=</span><span class="st">"Loadings on RDA1"</span>)
<span class="fu"><a href="https://rdrr.io/r/graphics/hist.html">hist</a></span>(<span class="no">load.rda</span>[,<span class="fl">2</span>], <span class="kw">main</span><span class="kw">=</span><span class="st">"Loadings on RDA2"</span>)
<span class="fu"><a href="https://rdrr.io/r/graphics/hist.html">hist</a></span>(<span class="no">load.rda</span>[,<span class="fl">3</span>], <span class="kw">main</span><span class="kw">=</span><span class="st">"Loadings on RDA3"</span>)</pre></body></html></div>
<p><img src="Week11_vignette_files/figure-html/loadings_plot-1.png" width="240"><img src="Week11_vignette_files/figure-html/loadings_plot-2.png" width="240"><img src="Week11_vignette_files/figure-html/loadings_plot-3.png" width="240"></p>
<p>I’ve written a simple function to identify SNPs that load in the tails of these distributions. We’ll start with a 3 standard deviation cutoff (two-tailed p-value = 0.0027). As with all cutoffs, this can be modified to reflect the goals of the analysis and our tolerance for true positives vs. false positives. For example, if you needed to be very conservative and only identify those loci under very strong selection (i.e., minimize false positive rates), you could increase the number of standard deviations to 3.5 (two-tailed p-value = 0.0005). This would also increase the false negative rate. If you were less concerned with false positives, and more concerned with identifying as many potential candidate loci as possible (including those that may be under weaker selection), you might choose a 2.5 standard deviation cutoff (two-tailed p-value = 0.012).</p>
<p>I define the function here as <code>outliers</code>, where <code>x</code> is the vector of loadings and <code>z</code> is the number of standard deviations to use:</p>
<div class="sourceCode" id="cb49"><html><body><pre class="r"><span class="no">outliers</span> <span class="kw">&lt;-</span> <span class="kw">function</span>(<span class="no">x</span>,<span class="no">z</span>){
  <span class="no">lims</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span>(<span class="no">x</span>) + <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(-<span class="fl">1</span>, <span class="fl">1</span>) * <span class="no">z</span> * <span class="fu"><a href="https://rdrr.io/r/stats/sd.html">sd</a></span>(<span class="no">x</span>) <span class="co"># find loadings +/- z SD from mean loading     </span>
  <span class="no">x</span>[<span class="no">x</span> <span class="kw">&lt;</span> <span class="no">lims</span>[<span class="fl">1</span>] <span class="kw">|</span> <span class="no">x</span> <span class="kw">&gt;</span> <span class="no">lims</span>[<span class="fl">2</span>]]           <span class="co"># locus names in these tails</span>
}</pre></body></html></div>
<p>Now let’s apply it to the first three constrained axes:</p>
<div class="sourceCode" id="cb50"><html><body><pre class="r"><span class="no">cand1</span> <span class="kw">&lt;-</span> <span class="fu">outliers</span>(<span class="no">load.rda</span>[,<span class="fl">1</span>], <span class="fl">3</span>) <span class="co"># 38</span>
<span class="no">cand2</span> <span class="kw">&lt;-</span> <span class="fu">outliers</span>(<span class="no">load.rda</span>[,<span class="fl">2</span>], <span class="fl">3</span>) <span class="co"># 69</span>
<span class="no">cand3</span> <span class="kw">&lt;-</span> <span class="fu">outliers</span>(<span class="no">load.rda</span>[,<span class="fl">3</span>], <span class="fl">3</span>) <span class="co"># 34</span>

<span class="no">wolf.rda.cand</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/names.html">names</a></span>(<span class="no">cand1</span>), <span class="fu"><a href="https://rdrr.io/r/base/names.html">names</a></span>(<span class="no">cand2</span>), <span class="fu"><a href="https://rdrr.io/r/base/names.html">names</a></span>(<span class="no">cand3</span>)) <span class="co"># just the names of the candidates</span>

<span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span>(<span class="no">wolf.rda.cand</span>[<span class="fu"><a href="https://rdrr.io/r/base/duplicated.html">duplicated</a></span>(<span class="no">wolf.rda.cand</span>)]) <span class="co"># 7 duplicate detections (detected on multiple RDA axes)</span></pre></body></html></div>
<pre><code>## [1] 7</code></pre>
<div class="sourceCode" id="cb52"><html><body><pre class="r"><span class="no">wolf.rda.cand</span> <span class="kw">&lt;-</span> <span class="no">wolf.rda.cand</span>[!<span class="fu"><a href="https://rdrr.io/r/base/duplicated.html">duplicated</a></span>(<span class="no">wolf.rda.cand</span>)] <span class="co"># 134 unique candidates </span></pre></body></html></div>
<p>Let’s see where these candidate SNPs are in the ordination space. We’ll zoom the plot in to just the SNPs, and color code candidate SNPs in red:</p>
<div class="sourceCode" id="cb53"><html><body><pre class="r"><span class="co"># Set up the color scheme for plotting:</span>
<span class="no">bgcol</span>  <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html">ifelse</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span>(<span class="no">gen.imp</span>) <span class="kw">%in%</span> <span class="no">wolf.rda.cand</span>, <span class="st">'gray32'</span>, <span class="st">'#00000000'</span>)
<span class="no">snpcol</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html">ifelse</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span>(<span class="no">gen.imp</span>) <span class="kw">%in%</span> <span class="no">wolf.rda.cand</span>, <span class="st">'red'</span>, <span class="st">'#00000000'</span>)

<span class="co"># axes 1 &amp; 2 - zooming in to just the SNPs here...</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/plot.html">plot</a></span>(<span class="no">wolf.rda</span>, <span class="kw">type</span><span class="kw">=</span><span class="st">"n"</span>, <span class="kw">scaling</span><span class="kw">=</span><span class="fl">3</span>, <span class="kw">xlim</span><span class="kw">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(-<span class="fl">1</span>,<span class="fl">1</span>), <span class="kw">ylim</span><span class="kw">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(-<span class="fl">1</span>,<span class="fl">1</span>), <span class="kw">main</span><span class="kw">=</span><span class="st">"Wolf RDA, axes 1 and 2"</span>)
<span class="fu"><a href="https://rdrr.io/r/graphics/points.html">points</a></span>(<span class="no">wolf.rda</span>, <span class="kw">display</span><span class="kw">=</span><span class="st">"species"</span>, <span class="kw">pch</span><span class="kw">=</span><span class="fl">21</span>, <span class="kw">cex</span><span class="kw">=</span><span class="fl">1</span>, <span class="kw">col</span><span class="kw">=</span><span class="st">"gray32"</span>, <span class="kw">bg</span><span class="kw">=</span><span class="st">'#f1eef6'</span>, <span class="kw">scaling</span><span class="kw">=</span><span class="fl">3</span>)
<span class="fu"><a href="https://rdrr.io/r/graphics/points.html">points</a></span>(<span class="no">wolf.rda</span>, <span class="kw">display</span><span class="kw">=</span><span class="st">"species"</span>, <span class="kw">pch</span><span class="kw">=</span><span class="fl">21</span>, <span class="kw">cex</span><span class="kw">=</span><span class="fl">1</span>, <span class="kw">col</span><span class="kw">=</span><span class="no">bgcol</span>, <span class="kw">bg</span><span class="kw">=</span><span class="no">snpcol</span>, <span class="kw">scaling</span><span class="kw">=</span><span class="fl">3</span>)
<span class="fu"><a href="https://rdrr.io/r/graphics/text.html">text</a></span>(<span class="no">wolf.rda</span>, <span class="kw">scaling</span><span class="kw">=</span><span class="fl">3</span>, <span class="kw">display</span><span class="kw">=</span><span class="st">"bp"</span>, <span class="kw">col</span><span class="kw">=</span><span class="st">"#0868ac"</span>, <span class="kw">cex</span><span class="kw">=</span><span class="fl">1</span>)

<span class="co"># axes 2 &amp; 3</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/plot.html">plot</a></span>(<span class="no">wolf.rda</span>, <span class="kw">type</span><span class="kw">=</span><span class="st">"n"</span>, <span class="kw">scaling</span><span class="kw">=</span><span class="fl">3</span>, <span class="kw">xlim</span><span class="kw">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(-<span class="fl">1</span>,<span class="fl">1</span>), <span class="kw">ylim</span><span class="kw">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(-<span class="fl">1</span>,<span class="fl">1</span>), <span class="kw">choices</span><span class="kw">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">2</span>,<span class="fl">3</span>), <span class="kw">main</span><span class="kw">=</span><span class="st">"Wolf RDA, axes 2 and 3"</span>)
<span class="fu"><a href="https://rdrr.io/r/graphics/points.html">points</a></span>(<span class="no">wolf.rda</span>, <span class="kw">display</span><span class="kw">=</span><span class="st">"species"</span>, <span class="kw">pch</span><span class="kw">=</span><span class="fl">21</span>, <span class="kw">cex</span><span class="kw">=</span><span class="fl">1</span>, <span class="kw">col</span><span class="kw">=</span><span class="st">"gray32"</span>, <span class="kw">bg</span><span class="kw">=</span><span class="st">'#f1eef6'</span>, <span class="kw">scaling</span><span class="kw">=</span><span class="fl">3</span>, <span class="kw">choices</span><span class="kw">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">2</span>,<span class="fl">3</span>))
<span class="fu"><a href="https://rdrr.io/r/graphics/points.html">points</a></span>(<span class="no">wolf.rda</span>, <span class="kw">display</span><span class="kw">=</span><span class="st">"species"</span>, <span class="kw">pch</span><span class="kw">=</span><span class="fl">21</span>, <span class="kw">cex</span><span class="kw">=</span><span class="fl">1</span>, <span class="kw">col</span><span class="kw">=</span><span class="no">bgcol</span>, <span class="kw">bg</span><span class="kw">=</span><span class="no">snpcol</span>, <span class="kw">scaling</span><span class="kw">=</span><span class="fl">3</span>, <span class="kw">choices</span><span class="kw">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">2</span>,<span class="fl">3</span>))
<span class="fu"><a href="https://rdrr.io/r/graphics/text.html">text</a></span>(<span class="no">wolf.rda</span>, <span class="kw">scaling</span><span class="kw">=</span><span class="fl">3</span>, <span class="kw">display</span><span class="kw">=</span><span class="st">"bp"</span>, <span class="kw">col</span><span class="kw">=</span><span class="st">"#0868ac"</span>, <span class="kw">cex</span><span class="kw">=</span><span class="fl">1</span>, <span class="kw">choices</span><span class="kw">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">2</span>,<span class="fl">3</span>))</pre></body></html></div>
<p><img src="Week11_vignette_files/figure-html/unnamed-chunk-12-1.png" width="480"><img src="Week11_vignette_files/figure-html/unnamed-chunk-12-2.png" width="480"></p>
<p>Which environmental predictor(s) seem to be most strongly related to candidate SNPs in the RDA1/RDA2 plot? How about the RDA2/RDA3 plot?</p>
<p>Why do we see candidate SNPs loading in the center of the ordination space in both plots?</p>
<p>Let’s see which environmental predictors are most strongly correlated with the first three RDA axes:</p>
<div class="sourceCode" id="cb54"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/pkg/vegan/man/goodness.cca.html">intersetcor</a></span>(<span class="no">wolf.rda</span>)[,<span class="fl">1</span>:<span class="fl">3</span>]</pre></body></html></div>
<pre><code>##            RDA1        RDA2        RDA3
## AMT  -0.8692103  0.10797423  0.19767975
## MDR  -0.4791404  0.77837759 -0.09163633
## sdT   0.2971194  0.47503944 -0.03234453
## AP   -0.6902664 -0.62757476  0.09806042
## cvP   0.3155829  0.02749876 -0.64084267
## NDVI -0.6531881  0.24697034  0.07226876
## Elev -0.3473015  0.24167932 -0.33073363
## Tree -0.5699345  0.21080592  0.03478928</code></pre>
<p>Generally, candidate SNPs on axis 1 represent multilocus sets of SNP genotypes associated most strongly with annual mean temperature and annual precipitation; SNPs on axis 2 represent genotypes associated with mean diurnal range; and SNPs on axis 3 represent genotypes associated with precipitation seasonality. See the full <a href="http://popgen.nescent.org/2018-03-27_RDA_GEA.html">RDA vignette</a> for additional investigation of candidate SNPs.</p>
</div>
</div>
<div id="compare-lfmm-and-rda-candidates" class="section level2">
<h2 class="hasAnchor">
<a href="#compare-lfmm-and-rda-candidates" class="anchor"></a>5. Compare LFMM and RDA candidates</h2>
<p>Let’s see what kind of overlap we have in our candidates from the two methods. Remember that we had only 12 candidates for LFMM and 134 candidates for RDA.</p>
<div class="sourceCode" id="cb56"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/base/sets.html">intersect</a></span>(<span class="no">wolf.FDR.1</span>, <span class="no">wolf.rda.cand</span>) <span class="co"># found by both LFMM and RDA</span></pre></body></html></div>
<pre><code>##  [1] "chr6.36999927"  "chr20.36354466" "chr17.54224832" "chr12.58928631"
##  [5] "chr12.55629962" "chr8.41109194"  "chr19.17640345" "chr8.63918041" 
##  [9] "chr20.10469494" "chr22.64010061" "chr9.36496633"</code></pre>
<div class="sourceCode" id="cb58"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/base/sets.html">setdiff</a></span>(<span class="no">wolf.FDR.1</span>, <span class="no">wolf.rda.cand</span>)   <span class="co"># unique to LFMM</span></pre></body></html></div>
<pre><code>## [1] "chr5.25188969"</code></pre>
<p>We see a lot of overlap, even though the tests differ (e.g., correction for population structure, univariate vs. multivariate tests, differences in predictor variables, differences in post-processing).</p>
<p>An important note: A common approach in studies that use GEAs and populations differentiation methods is to use many tests and then look for the overlap across the detections. This can be helpful for some questions (e.g. where minimizing false positive detections is of greatest importance), but can be overly conservative in many cases and bias detections against weaker signatures of selection. See our paper for an investigation of different approaches for combining detections &amp; how it impacts true and false positive rates: Forester et al. (2018); and see the (excellent!) FDR paper for more options based on combining z-scores across different tests: Francois et al. (2016).</p>
</div>
<div id="a-quick-note-on-controlling-for-population-structure-in-rda" class="section level2">
<h2 class="hasAnchor">
<a href="#a-quick-note-on-controlling-for-population-structure-in-rda" class="anchor"></a>6. A quick note on controlling for population structure in RDA</h2>
<p>We are still testing approaches to controlling for population structure in RDA. We’ve generally found that using ancestry values (e.g. from <code>snmf</code> or Admixture) or MEMs (Moran’s Eigenvector Maps, aka spatial eigenvectors) is overly conservative.</p>
<p>So far, the best approach (e.g. balancing true positives and false negatives) is to compute a PCA of the genetic data and select relevant PCs (e.g. using the broken stick criteron as we did above), then use retained PCs in a partial RDA:</p>
<div class="sourceCode" id="cb60"><html><body><pre class="r">?rda  # help for running RDA

# pseudo code for simple RDA:
foo &lt;- rda(genomic.data ~ predictor1 + predictor2, data=dat

# pseudo code for partial RDA (correcting for population structure with PCs):
bar &lt;- rda(genomic.data ~ predictor1 + predictor2 + Condition(PC1), data=dat, scale=T)</pre></body></html></div>
<p>You will want to check for correlations between retained PCs and your environmental predictors. If environment and population structure are not correlated, you can retain all predictors and PCs and proceed with your partial RDA. If environment and population structure <em>are</em> highly correlated, you’ll have to decide whether to prune correlated environmental variables or PCs. Pruning environmental variables will likely reduce false positives but will also increase false negatives. Pruning PCs (instead of environmental predictors) will likely increase false positives, but will also reduce false negatives. These trade-offs exist with all approaches for controlling population structure and other confounding factors when environment is correlated with population structure.</p>
</div>
<div id="references" class="section level2">
<h2 class="hasAnchor">
<a href="#references" class="anchor"></a>7. References</h2>
<p>Borcard D, Gillet F, Legendre P (2011) <a href="http://www.springer.com/us/book/9781441979759"><em>Numerical Ecology with R</em></a>. Springer, New York.</p>
<p>Caye K, Jumentier B, Lepeule J, Francois O (2019) <a href="https://academic.oup.com/mbe/article/36/4/852/5290100">LFMM 2: Fast and Accurate Inference of Gene-Environment Associations in Genome-Wide Studies</a>. <em>Molecular Biology and Evolution</em> 36: 852-860.</p>
<p>Dormann CF, Elith J, Bacher S, et al. (2013) <a href="http://onlinelibrary.wiley.com/doi/10.1111/j.1600-0587.2012.07348.x/abstract">Collinearity: a review of methods to deal with it and a simulation study evaluating their performance</a>. <em>Ecography</em>, 36: 27-46.</p>
<p>Forester BR, Lasky JR, Wagner HH, Urban DL (2018) <a href="https://www.biorxiv.org/content/early/2017/12/17/129460">Comparing methods for detecting multilocus adaptation with multivariate genotype-environment associations</a>. <em>Molecular Ecology</em>.</p>
<p>Forester BR (2018) <a href="http://popgen.nescent.org/2018-03-27_RDA_GEA.html">Vignette: Detectingn multilocus adaptation using Redundancy Analysis (RDA)</a>. Population Genetics in R: <a href="http://popgen.nescent.org/">popgen.nescent.org</a>.</p>
<p>Francois O, Martins H, Caye, K, Schoville S (2016) <a href="http://onlinelibrary.wiley.com/doi/10.1111/mec.13513/full">Controlling false discoveries in genome scans for selection</a>. <em>Molecular Ecology</em>, 25: 454-469.</p>
<p>Frichot E, Francois O (2015) <a href="http://onlinelibrary.wiley.com/doi/10.1111/2041-210X.12382/abstract">LEA: An R package for landscape and ecological association studies</a>. <em>Methods in Ecology and Evolution</em>, 6: 925-929.</p>
<p>Jombart, T (2008) <a href="https://academic.oup.com/bioinformatics/article/24/11/1403/191127">adegenet: a R package for the multivariate analysis of genetic markers</a>. <em>Bioinformatics</em>, 24: 1403-1405.</p>
<p>Jumentier B, Caye K, Heude B, Lepeule J, Francois O (2020) <a href="https://www.biorxiv.org/content/10.1101/2020.02.07.938381v1.abstract">Sparse latent factor regression models for genome-wide and epigenome-wide association studies</a>. <em>bioRxiv</em>, 2020.02.07.938381.</p>
<p>Legendre P, Oksanen J, ter Braak CJ (2010) <a href="https://besjournals.onlinelibrary.wiley.com/doi/full/10.1111/j.2041-210X.2010.00078.x">Testing the significance of canonical axes in redundancy analysis</a>. <em>Methods in Ecology and Evolution</em>, 2: 269-277.</p>
<p>Money D, Migicovsky Z, Gardner K, Myles S (2017) <a href="https://bmcgenomics.biomedcentral.com/articles/10.1186/s12864-017-3873-5">LinkImputeR: user-guided genotype calling and imputation for non-model organisms</a>. <em>BMC Genomics</em>, 18: 1-12.</p>
<p>Oksanen J, Blanchet FG, Kindt R, et al. (2016) <a href="https://CRAN.R-project.org/package=vegan"><em>vegan: Community Ecology Package</em></a>. R package version 2.3-5.</p>
<p>Rellstab C, Gugerli F, Eckert AJ, Hancock AM, Holderegger R (2015) <a href="http://onlinelibrary.wiley.com/doi/10.1111/mec.13322/abstract">A practical guide to environmental association analysis in landscape genomics</a>. <em>Molecular Ecology</em>, 24: 4348-4370.</p>
<p>Schweizer RM, vonHoldt BM, Harrigan R, et al. (2016) <a href="http://onlinelibrary.wiley.com/doi/10.1111/mec.13364/full">Genetic subdivision and candidate genes under selection in North American grey wolves</a>. <em>Molecular Ecology</em>, 25: 380-402.</p>
<p>Storey JD, Tibshirani R (2003) <a href="http://www.pnas.org/content/100/16/9440.full">Statistical significance for genome-wide experiments</a>. <em>Proceedings of the National Academy of Sciences</em>, 100: 9440-9445.</p>
<p>Zuur AF, Ieno EN, Elphick CS (2010) <a href="https://besjournals.onlinelibrary.wiley.com/doi/full/10.1111/j.2041-210X.2009.00001.x">A protocol for data exploration to avoid common statistical problems</a>. <em>Methods in Ecology and Evolution</em>, 1: 3-14.</p>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p>Developed by <a href="http://sites.utm.utoronto.ca/wagnerlab/">Helene Wagner</a>.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.5.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
