<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Week 9: Population Structure • LandGenCourse</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/cerulean/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Week 9: Population Structure">
<meta property="og:description" content="LandGenCourse">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--><!-- Global site tag (gtag.js) - Google Analytics --><script async src="https://www.googletagmanager.com/gtag/js?id=UA-168837293-1"></script><script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-168837293-1');
</script>
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">LandGenCourse</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">1.4.5</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/Week0_BasicR.html">Week 0: Intro to R Programming</a>
    </li>
    <li>
      <a href="../articles/Week0_Graphics.html">Week 0: R Graphics</a>
    </li>
    <li>
      <a href="../articles/Week1_vignette.html">Week 1: Importing Genetic Data</a>
    </li>
    <li>
      <a href="../articles/Week2_vignette.html">Week 2: Spatial Data</a>
    </li>
    <li>
      <a href="../articles/Week2_bonus_vignette.html">Week 2: Bonus Material</a>
    </li>
    <li>
      <a href="../articles/Week3_vignette.html">Week 3: Genetic Diversity</a>
    </li>
    <li>
      <a href="../articles/Week4_vignette.html">Week 4: Metapopulation Genetics</a>
    </li>
    <li>
      <a href="../articles/Week5_vignette.html">Week 5: Spatial Statistics</a>
    </li>
    <li>
      <a href="../articles/Week6_vignette.html">Week 6: Quantitative Genetics</a>
    </li>
    <li>
      <a href="../articles/Week7_vignette.html">Week 7: Spatial Linear Models</a>
    </li>
    <li>
      <a href="../articles/Week8_vignette.html">Week 8: Simulation</a>
    </li>
    <li>
      <a href="../articles/Week8_bonus_vignette.html">Week 8: Bonus Material</a>
    </li>
    <li>
      <a href="../articles/Week9_vignette.html">Week 9: Population Structure</a>
    </li>
    <li>
      <a href="../articles/Week10_vignette.html">Week 10: Landscape Resistance</a>
    </li>
    <li>
      <a href="../articles/Week11_vignette.html">Week 11: Detecting Adaptation</a>
    </li>
    <li>
      <a href="../articles/Week12_vignette.html">Week 12: Model Selection</a>
    </li>
    <li>
      <a href="../articles/Week13_vignette.html">Week 13: Gravity Models</a>
    </li>
    <li>
      <a href="../articles/Week14_vignette.html">Week 14: Contemporary Gene Flow</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Tutorials
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../tutorials/00-Intro_RStudio.html">Introduction to RStudio</a>
    </li>
    <li>
      <a href="../tutorials/00-Intro_LandGenCourse.html">Introduction to the LandGenCourse package</a>
    </li>
    <li>
      <a href="../tutorials/00-Intro_RNotebooks.html">Introduction to R Notebooks</a>
    </li>
    <li>
      <a href="../tutorials/00-Version_Control.html">Version Control 101</a>
    </li>
    <li>
      <a href="../tutorials/01-Genetic_Data.html">Week 1 Getting Landscape Genetic Data into R</a>
    </li>
    <li>
      <a href="../tutorials/02-Spatial_Data.html">Week 2 Land Cover Analysis in R</a>
    </li>
    <li>
      <a href="../tutorials/03-Genetic_Diversity.html">Week 3 Genetic Diversity (Part 1)</a>
    </li>
    <li>
      <a href="../tutorials/03-Genetic_Diversity_Part2.html">Week 3 Genetic Diversity (Part 2)</a>
    </li>
    <li>
      <a href="../tutorials/04-Metapop_Genetics.html">Week 4 Metapopulation Genetics (Part 1)</a>
    </li>
    <li>
      <a href="../tutorials/04-Metapop_Genetics_Part2.html">Week 4 Metapopulation Genetics (Part 2)</a>
    </li>
    <li>
      <a href="../tutorials/05-Spatial_Stats.html">Week 5 Spatial Statistics</a>
    </li>
    <li>
      <a href="../tutorials/06-Quantitative_Genetics.html">Week 6 Quantitative Genetics (Part 1)</a>
    </li>
    <li>
      <a href="../tutorials/06-Quantitative_Genetics_Part2.html">Week 6 Quantitative Genetics (Part 1)</a>
    </li>
    <li>
      <a href="../tutorials/07-Spatial_Models.html">Week 7 Spatial Linear Models (Part 1)</a>
    </li>
    <li>
      <a href="../tutorials/07-Spatial_Models_Part2.html">Week 7 Spatial Linear Models (Part 2)</a>
    </li>
    <li>
      <a href="../tutorials/08-Modeling.html">Week 8 Simulation Experiments in R (Part 1)</a>
    </li>
    <li>
      <a href="../tutorials/08-Modeling_Part2.html">Week 8 Simulation Experiments in R (Part 1)</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right"></ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Week 9: Population Structure</h1>
                        <h4 class="author">Sean Schoville</h4>
            
            <h4 class="date">2020-06-08</h4>
      
      
      <div class="hidden name"><code>Week9_vignette.Rmd</code></div>

    </div>

    
    
<div id="overview-of-worked-example" class="section level2">
<h2 class="hasAnchor">
<a href="#overview-of-worked-example" class="anchor"></a>1. Overview of Worked Example</h2>
<div id="a-goals" class="section level3">
<h3 class="hasAnchor">
<a href="#a-goals" class="anchor"></a>a) Goals</h3>
<p>The goals of this lab are to:</p>
<ul>
<li>Assess how patterns of genetic variation can be used to delimit natural populations.</li>
<li>Compare methods that assess population structure.</li>
<li>Understand how population structure can be used to interpret biogeographic history.</li>
</ul>
</div>
<div id="b-data-sets" class="section level3">
<h3 class="hasAnchor">
<a href="#b-data-sets" class="anchor"></a>b) Data sets</h3>
<p>All files are distributed as system files with the ‘LandGenCourse’ package (folder ‘extdata’).</p>
<ul>
<li>Simulated data using the two-island model and admixture model.</li>
<li>SNP data from Catchen et al. 2013 Catchen et al. 2013. The population structure and recent colonization history of Oregon threespine stickleback determined using restriction-site associated DNA-sequencing. Molecular Ecology 22:1365-294X. <a href="http://dx.doi.org/10.1111/mec.12330" class="uri">http://dx.doi.org/10.1111/mec.12330</a>
</li>
</ul>
</div>
<div id="c-required-r-libraries" class="section level3">
<h3 class="hasAnchor">
<a href="#c-required-r-libraries" class="anchor"></a>c) Required R libraries</h3>
<p>All required packages should have been installed already when you installed ‘LandGenCourse’.</p>
<p>Note: the function ‘library’ will always load the package, even if it is already loaded, whereas ‘require’ will only load it if it is not yet loaded. Either will work.</p>
<div class="sourceCode" id="cb1"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/base/library.html">require</a></span>(<span class="no">LandGenCourse</span>)
<span class="co">#require(fields)  </span>
<span class="co">#require(RColorBrewer)</span>
<span class="co">#require(maps)</span>
<span class="co">#require(mapplots)</span>
<span class="co">#require(here)</span></pre></body></html></div>
<p>The package ‘LEA’ is available from the ‘Bioconductor’ repository. Also, package ‘fields’ was not installed with ‘LandGenCourse’ automatically due to compatibility issues.</p>
<div class="sourceCode" id="cb2"><html><body><pre class="r"><span class="kw">if</span>(!<span class="fu"><a href="https://rdrr.io/r/base/ns-load.html">requireNamespace</a></span>(<span class="st">"fields"</span>, <span class="kw">quietly</span> <span class="kw">=</span> <span class="fl">TRUE</span>)) <span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html">install.packages</a></span>(<span class="st">"fields"</span>, <span class="kw">repos</span><span class="kw">=</span><span class="st">'http://cran.us.r-project.org'</span>)

<span class="kw">if</span>(!<span class="fu"><a href="https://rdrr.io/r/base/ns-load.html">requireNamespace</a></span>(<span class="st">"LEA"</span>, <span class="kw">quietly</span> <span class="kw">=</span> <span class="fl">TRUE</span>)) {
  <span class="kw">if</span> (!<span class="fu"><a href="https://rdrr.io/r/base/ns-load.html">requireNamespace</a></span>(<span class="st">"BiocManager"</span>, <span class="kw">quietly</span> <span class="kw">=</span> <span class="fl">TRUE</span>))
    <span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html">install.packages</a></span>(<span class="st">"BiocManager"</span>)
  <span class="kw pkg">BiocManager</span><span class="kw ns">::</span><span class="fu"><a href="https://rdrr.io/pkg/BiocManager/man/install.html">install</a></span>(<span class="st">"LEA"</span>)
}</pre></body></html></div>
<pre><code>## 
## The downloaded binary packages are in
##  /var/folders/kz/fv8pzy0d3cl_mp3md294cvbh0000gn/T//RtmpljQKRi/downloaded_packages</code></pre>
</div>
</div>
<div id="simulated-data-2-island-model" class="section level2">
<h2 class="hasAnchor">
<a href="#simulated-data-2-island-model" class="anchor"></a>2. Simulated data: 2-island model</h2>
<p>We simulated data under a classic two-island model, using the coalescent simulation program ‘ms’, developed by Richard Hudson. The program simulates a coalescent tree under various demographic models, and uses those trees to create allelic data. For those interested in using ‘ms’, the source code is available here: <a href="http://home.uchicago.edu/rhudson1/source/mksamples.html" class="uri">http://home.uchicago.edu/rhudson1/source/mksamples.html</a></p>
<p>We simulated 200 haploid individuals genotyped at 100 loci. The effective mutation rate was ‘μ = 0.5’. We sampled 2 islands with 100 individuals in each. The effective migration rate was ‘Nm 2’ (‘N’ is the effective size in each of the two island, ‘m’ is the bidirectional rate of gene flow).</p>
<p>Our ms command was as follows: ms 200 100 -t .5 -I 2 100 100 -ma x 2 2 x &gt; dataNm2.txt</p>
<p>These raw data need to be converted in a format amenable to statistical analyses in R.</p>
<div id="a-import-data" class="section level3">
<h3 class="hasAnchor">
<a href="#a-import-data" class="anchor"></a>a) Import data</h3>
<div class="sourceCode" id="cb4"><html><body><pre class="r"><span class="no">file</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/scan.html">scan</a></span>(<span class="kw">file</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html">system.file</a></span>(<span class="st">"extdata"</span>, <span class="st">"dataNm2.txt"</span>, <span class="kw">package</span> <span class="kw">=</span> <span class="st">"LandGenCourse"</span>),
             <span class="kw">what</span> <span class="kw">=</span><span class="st">"character"</span>, <span class="kw">sep</span><span class="kw">=</span><span class="st">"\n"</span>, <span class="kw">skip</span> <span class="kw">=</span> <span class="fl">2</span>)
<span class="no">genotype</span> <span class="kw">&lt;-</span> <span class="kw">NULL</span>
<span class="kw">for</span>(<span class="no">locus</span> <span class="kw">in</span> <span class="fl">1</span>:<span class="fl">100</span>){
    <span class="no">res.locus</span> <span class="kw">&lt;-</span> <span class="no">file</span>[<span class="fl">4</span>:<span class="fl">203</span>]
    <span class="no">file</span> <span class="kw">&lt;-</span> <span class="no">file</span>[-(<span class="fl">1</span>:<span class="fl">203</span>)]
    <span class="no">genotype</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html">cbind</a></span>(<span class="no">genotype</span>, <span class="fu"><a href="https://rdrr.io/r/base/numeric.html">as.numeric</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/factor.html">as.factor</a></span>(<span class="no">res.locus</span>)))}
<span class="fu"><a href="https://rdrr.io/r/base/dim.html">dim</a></span>(<span class="no">genotype</span>)</pre></body></html></div>
<pre><code>## [1] 200 100</code></pre>
<p>Now we have a new data file, genotype, loaded in R. This file contains 200 rows and 100 columns. Each row corresponds to a simulated individual. The columns code for their multi-locus genotypes.</p>
</div>
<div id="b-perform-principal-components-analysis-pca" class="section level3">
<h3 class="hasAnchor">
<a href="#b-perform-principal-components-analysis-pca" class="anchor"></a>b) Perform Principal Components Analysis (PCA)</h3>
<p>Our first objective is to use ordination (Principal components analysis, or PCA) to examine population structure for the Nm = 2 data set.</p>
<p>The R command for PCA is fairly simple and fast:</p>
<div class="sourceCode" id="cb6"><html><body><pre class="r"><span class="no">pc</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/prcomp.html">prcomp</a></span>(<span class="no">genotype</span>, <span class="kw">scale</span> <span class="kw">=</span><span class="no">T</span>)</pre></body></html></div>
<p>In order to visualize how the first two eigenvectors capture genotype variation, we will color each population.</p>
<div class="sourceCode" id="cb7"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/graphics/par.html">par</a></span>(<span class="kw">mar</span><span class="kw">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">4</span>,<span class="fl">4</span>,<span class="fl">0.5</span>,<span class="fl">0.5</span>))
<span class="fu"><a href="https://rdrr.io/r/graphics/plot.html">plot</a></span>(<span class="no">pc</span>$<span class="no">x</span>, <span class="kw">pch</span> <span class="kw">=</span> <span class="fl">19</span>, <span class="kw">cex</span> <span class="kw">=</span> <span class="fl">2</span>, <span class="kw">col</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"blue2"</span>, <span class="st">"orange"</span>), <span class="kw">each</span> <span class="kw">=</span> <span class="fl">100</span>))</pre></body></html></div>
<p><img src="Week9_vignette_files/figure-html/unnamed-chunk-5-1.png" width="700"></p>
<p><strong>Question 1:</strong></p>
<ul>
<li>Is population structure (genetic differentiation) evident?</li>
<li>How much of the genetic variance can be explained by our first two components?</li>
</ul>
<p>To answer the second part of this question, use:</p>
<div class="sourceCode" id="cb8"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span>(<span class="no">pc</span>)</pre></body></html></div>
<pre><code>## Importance of components:
##                            PC1     PC2    PC3     PC4     PC5     PC6     PC7
## Standard deviation     2.77699 1.65283 1.5587 1.53452 1.48944 1.48496 1.46718
## Proportion of Variance 0.07712 0.02732 0.0243 0.02355 0.02218 0.02205 0.02153
## Cumulative Proportion  0.07712 0.10443 0.1287 0.15228 0.17446 0.19651 0.21804
##                            PC8     PC9    PC10    PC11    PC12    PC13    PC14
## Standard deviation     1.43774 1.41957 1.40980 1.40041 1.38541 1.37335 1.35879
## Proportion of Variance 0.02067 0.02015 0.01988 0.01961 0.01919 0.01886 0.01846
## Cumulative Proportion  0.23871 0.25886 0.27874 0.29835 0.31754 0.33640 0.35487
##                           PC15    PC16   PC17    PC18    PC19    PC20    PC21
## Standard deviation     1.35395 1.31441 1.3078 1.30115 1.29493 1.26846 1.26525
## Proportion of Variance 0.01833 0.01728 0.0171 0.01693 0.01677 0.01609 0.01601
## Cumulative Proportion  0.37320 0.39048 0.4076 0.42451 0.44128 0.45737 0.47338
##                           PC22    PC23    PC24    PC25    PC26    PC27    PC28
## Standard deviation     1.23786 1.23212 1.22814 1.20358 1.18924 1.17923 1.17139
## Proportion of Variance 0.01532 0.01518 0.01508 0.01449 0.01414 0.01391 0.01372
## Cumulative Proportion  0.48870 0.50388 0.51896 0.53345 0.54759 0.56150 0.57522
##                           PC29    PC30    PC31    PC32    PC33    PC34    PC35
## Standard deviation     1.16216 1.12304 1.10610 1.10157 1.09177 1.07816 1.05735
## Proportion of Variance 0.01351 0.01261 0.01223 0.01213 0.01192 0.01162 0.01118
## Cumulative Proportion  0.58873 0.60134 0.61357 0.62571 0.63763 0.64925 0.66043
##                           PC36    PC37    PC38    PC39    PC40    PC41    PC42
## Standard deviation     1.04793 1.02672 1.01936 1.01364 1.00225 0.99349 0.98594
## Proportion of Variance 0.01098 0.01054 0.01039 0.01027 0.01005 0.00987 0.00972
## Cumulative Proportion  0.67141 0.68195 0.69235 0.70262 0.71267 0.72254 0.73226
##                           PC43    PC44   PC45    PC46    PC47    PC48    PC49
## Standard deviation     0.96673 0.96357 0.9485 0.94380 0.92308 0.91570 0.90220
## Proportion of Variance 0.00935 0.00928 0.0090 0.00891 0.00852 0.00839 0.00814
## Cumulative Proportion  0.74160 0.75089 0.7599 0.76879 0.77731 0.78570 0.79384
##                           PC50    PC51    PC52    PC53    PC54    PC55    PC56
## Standard deviation     0.89163 0.88277 0.86488 0.84941 0.83872 0.83328 0.82304
## Proportion of Variance 0.00795 0.00779 0.00748 0.00721 0.00703 0.00694 0.00677
## Cumulative Proportion  0.80179 0.80958 0.81706 0.82427 0.83131 0.83825 0.84503
##                           PC57    PC58    PC59    PC60    PC61    PC62   PC63
## Standard deviation     0.81748 0.80746 0.79085 0.77042 0.76650 0.76104 0.7553
## Proportion of Variance 0.00668 0.00652 0.00625 0.00594 0.00588 0.00579 0.0057
## Cumulative Proportion  0.85171 0.85823 0.86448 0.87042 0.87629 0.88209 0.8878
##                           PC64   PC65    PC66    PC67    PC68    PC69    PC70
## Standard deviation     0.72978 0.7279 0.72353 0.70575 0.69818 0.68517 0.68335
## Proportion of Variance 0.00533 0.0053 0.00523 0.00498 0.00487 0.00469 0.00467
## Cumulative Proportion  0.89312 0.8984 0.90365 0.90863 0.91351 0.91820 0.92287
##                           PC71    PC72    PC73    PC74    PC75    PC76    PC77
## Standard deviation     0.67501 0.65756 0.63896 0.62114 0.61388 0.60925 0.60217
## Proportion of Variance 0.00456 0.00432 0.00408 0.00386 0.00377 0.00371 0.00363
## Cumulative Proportion  0.92743 0.93175 0.93583 0.93969 0.94346 0.94717 0.95080
##                           PC78    PC79    PC80    PC81    PC82    PC83    PC84
## Standard deviation     0.58408 0.56742 0.55817 0.54962 0.53610 0.52625 0.52442
## Proportion of Variance 0.00341 0.00322 0.00312 0.00302 0.00287 0.00277 0.00275
## Cumulative Proportion  0.95421 0.95743 0.96054 0.96356 0.96644 0.96921 0.97196
##                           PC85    PC86   PC87    PC88    PC89    PC90    PC91
## Standard deviation     0.50528 0.49755 0.4798 0.46734 0.45256 0.44882 0.44121
## Proportion of Variance 0.00255 0.00248 0.0023 0.00218 0.00205 0.00201 0.00195
## Cumulative Proportion  0.97451 0.97699 0.9793 0.98147 0.98352 0.98554 0.98748
##                           PC92    PC93    PC94    PC95    PC96    PC97    PC98
## Standard deviation     0.41786 0.41163 0.39781 0.37758 0.36923 0.36602 0.34913
## Proportion of Variance 0.00175 0.00169 0.00158 0.00143 0.00136 0.00134 0.00122
## Cumulative Proportion  0.98923 0.99092 0.99251 0.99393 0.99529 0.99663 0.99785
##                           PC99   PC100
## Standard deviation     0.34128 0.31336
## Proportion of Variance 0.00116 0.00098
## Cumulative Proportion  0.99902 1.00000</code></pre>
<p>Next we would like to see how population genetic structure relates to geographic space. To this aim, we could display PC maps. A PC map is a spatial interpolation of a particular component. Let’s map PC 1.</p>
</div>
<div id="c-create-synthetic-spatial-coordinates-xy-and-map-them" class="section level3">
<h3 class="hasAnchor">
<a href="#c-create-synthetic-spatial-coordinates-xy-and-map-them" class="anchor"></a>c) Create synthetic spatial coordinates (X,Y) and map them</h3>
<div class="sourceCode" id="cb10"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/graphics/par.html">par</a></span>(<span class="kw">mar</span><span class="kw">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">4</span>,<span class="fl">4</span>,<span class="fl">0.5</span>,<span class="fl">0.5</span>))
<span class="no">coord</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html">cbind</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/sort.html">sort</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span>(<span class="fl">100</span>, -<span class="fl">2</span>, <span class="fl">1</span>), <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span>(<span class="fl">100</span>, <span class="fl">2</span>, <span class="fl">1</span>))), <span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html">runif</a></span>(<span class="fl">200</span>))
<span class="no">fit</span>  <span class="kw">&lt;-</span> <span class="kw pkg">fields</span><span class="kw ns">::</span><span class="fu"><a href="https://rdrr.io/pkg/fields/man/Krig.html">Krig</a></span>(<span class="no">coord</span>, <span class="no">pc</span>$<span class="no">x</span>[,<span class="fl">1</span>], <span class="kw">m</span><span class="kw">=</span><span class="fl">1</span>)
<span class="kw pkg">fields</span><span class="kw ns">::</span><span class="fu"><a href="https://rdrr.io/pkg/fields/man/fields-internal.html">surface</a></span>(<span class="no">fit</span>)
<span class="fu"><a href="https://rdrr.io/r/graphics/points.html">points</a></span>(<span class="no">coord</span>, <span class="kw">pch</span><span class="kw">=</span><span class="fl">19</span>)</pre></body></html></div>
<p><img src="Week9_vignette_files/figure-html/unnamed-chunk-7-1.png" width="672"></p>
<p>This map predicts the value of the first principal component at each location in our study area. We observe that the study area is partitioned into two zones that correspond to the 2 clusters visible from PC 1. We have superimposed individual sample sites to see our species distribution.</p>
<p>To check that the PC map is consistent with having 2 islands, we can examine the PC assignment vs the sampling location. Remember that, in the data sets, the 100 first individuals were sampled from island 1 and the last 100 were sampled from island 2. We compare these assignments to the PCA classification as follows.</p>
<div class="sourceCode" id="cb11"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/base/table.html">table</a></span>((<span class="no">pc</span>$<span class="no">x</span>[,<span class="fl">1</span>] <span class="kw">&gt;</span> <span class="fl">0</span>) <span class="kw">==</span> (<span class="fl">1</span>:<span class="fl">200</span> <span class="kw">&lt;=</span> <span class="fl">100</span>))</pre></body></html></div>
<pre><code>## 
## FALSE  TRUE 
##     1   199</code></pre>
<p>In this example, we found that only one individual was not assigned to its island of origin. Well, this individual might be a migrant from the last generation. These results indicated that a very simple method based on principal component analysis can correctly describe spatial population genetic structure.</p>
<p><strong>Question 2:</strong> Does PCA provide an accurate description of population genetic structure when the genetic differentiation between the 2 islands is less pronounced?</p>
<p>To answer this question, re-run the first analytical steps up to PCA for data simulated with Nm = 10 (a higher value of gene flow), which is stored in datafile “dataNm10.txt”. This was generated with the following ms command:</p>
<p>ms 200 100 -t .5 -I 2 100 100 -ma x 10 10 x &gt; dataNm10.txt</p>
<p>You can import the file as:</p>
<div class="sourceCode" id="cb13"><html><body><pre class="r"><span class="no">file</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/scan.html">scan</a></span>(<span class="kw">file</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html">system.file</a></span>(<span class="st">"extdata"</span>, <span class="st">"dataNm10.txt"</span>, <span class="kw">package</span> <span class="kw">=</span> <span class="st">"LandGenCourse"</span>),
             <span class="kw">what</span> <span class="kw">=</span><span class="st">"character"</span>, <span class="kw">sep</span><span class="kw">=</span><span class="st">"\n"</span>, <span class="kw">skip</span> <span class="kw">=</span> <span class="fl">2</span>)</pre></body></html></div>
</div>
</div>
<div id="simulated-data-2-island-model-with-admixture" class="section level2">
<h2 class="hasAnchor">
<a href="#simulated-data-2-island-model-with-admixture" class="anchor"></a>3. Simulated data: 2-island model with admixture</h2>
<div class="figure">
<img src="WE9_Fig1.png" alt="2-island model"><p class="caption">2-island model</p>
</div>
<p>A 2-island model is a relatively simple scenario and unlikely to capture the variation we will see in empirical studies. Will our very basic assignment method based on PCA hold up to more complex scenarios?</p>
<p>Let’s consider a scenario where the 2 populations had been evolving for a long time under an equilibrium island model, and then their environment suddenly changed. Our 2 populations had to move to track their shifting habitat, and after these movements they come into contact in an intermediate region. This contact event resulted in an admixed population with the density of mixed individuals greater in the center of the contact zone than at the ancestral origins at the edges of the landscape.</p>
<p>Using R and our previous simulation, a multi-locus cline that resumes this scenario can be simulated has follows. The source population data are in the file “dataNm1.str”.</p>
<p>First we define a function for the shape of a cline:</p>
<div class="sourceCode" id="cb14"><html><body><pre class="r"><span class="co"># A function for the shape of a cline</span>
<span class="no">sigmoid</span> <span class="kw">&lt;-</span> <span class="kw">function</span>(<span class="no">x</span>){ <span class="fl">1</span>/(<span class="fl">1</span> + <span class="fu"><a href="https://rdrr.io/r/base/Log.html">exp</a></span>(-<span class="no">x</span>))}
<span class="no">p1</span> <span class="kw">&lt;-</span> <span class="fu">sigmoid</span>( <span class="fl">0.5</span> * <span class="no">coord</span>[,<span class="fl">1</span>])</pre></body></html></div>
<p>Our admixed genotypes are built from a 2 island model with low gene flow (Nm=1)</p>
<div class="sourceCode" id="cb15"><html><body><pre class="r"><span class="no">genotype</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/utils/read.table.html">read.table</a></span>(<span class="kw">file</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html">system.file</a></span>(<span class="st">"extdata"</span>, <span class="st">"dataNm1.str"</span>, <span class="kw">package</span> <span class="kw">=</span> <span class="st">"LandGenCourse"</span>))[,-(<span class="fl">1</span>:<span class="fl">2</span>)]
<span class="no">admixed.genotype</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span>(<span class="fl">NA</span>, <span class="kw">ncol</span> <span class="kw">=</span> <span class="fl">100</span>, <span class="kw">nrow</span> <span class="kw">=</span> <span class="fl">200</span>)
<span class="kw">for</span> (<span class="no">i</span> <span class="kw">in</span> <span class="fl">1</span>:<span class="fl">100</span>){ <span class="kw">for</span> (<span class="no">j</span> <span class="kw">in</span> <span class="fl">1</span>:<span class="fl">100</span>)
<span class="no">admixed.genotype</span>[<span class="no">i</span>,<span class="no">j</span>] <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sample.html">sample</a></span>( <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="no">genotype</span>[<span class="no">i</span>, <span class="no">j</span>],<span class="no">genotype</span>[<span class="no">i</span>+<span class="fl">100</span>, <span class="no">j</span>]), <span class="fl">1</span>, <span class="kw">prob</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="no">p1</span>[<span class="no">i</span>], <span class="fl">1</span> - <span class="no">p1</span>[<span class="no">i</span>]) )}

<span class="kw">for</span> (<span class="no">i</span> <span class="kw">in</span> <span class="fl">101</span>:<span class="fl">200</span>){ <span class="kw">for</span> (<span class="no">j</span> <span class="kw">in</span> <span class="fl">1</span>:<span class="fl">100</span>)
<span class="no">admixed.genotype</span>[<span class="no">i</span>,<span class="no">j</span>] <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sample.html">sample</a></span>( <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="no">genotype</span>[<span class="no">i</span> - <span class="fl">100</span>, <span class="no">j</span>],<span class="no">genotype</span>[<span class="no">i</span>, <span class="no">j</span>]), <span class="fl">1</span>, <span class="kw">prob</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="no">p1</span>[<span class="no">i</span>], <span class="fl">1</span> - <span class="no">p1</span>[<span class="no">i</span>]) )}
<span class="no">res</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span>(<span class="no">coord</span>, <span class="no">admixed.genotype</span>)</pre></body></html></div>
<p>Now our data set is the R object ‘res’. The next exercise is to apply PCA to these data to evaluate how geographical genetic variation can be captured by this approach. In comparison with the previous example where we had two geographically discrete populations, we now have a “continuous” population in a landscape. Geographical genetic variation is thus expected to be more gradual than in the previous example. Generate and examine the PC 1 map.</p>
<div class="sourceCode" id="cb16"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/graphics/par.html">par</a></span>(<span class="kw">mar</span><span class="kw">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">4</span>,<span class="fl">4</span>,<span class="fl">0.5</span>,<span class="fl">0.5</span>))
<span class="no">pcA</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/prcomp.html">prcomp</a></span>(<span class="no">admixed.genotype</span>, <span class="kw">scale</span> <span class="kw">=</span><span class="no">T</span>)
<span class="fu"><a href="https://rdrr.io/r/graphics/plot.html">plot</a></span>(<span class="no">pcA</span>$<span class="no">x</span>, <span class="kw">pch</span> <span class="kw">=</span> <span class="fl">19</span>, <span class="kw">cex</span> <span class="kw">=</span> <span class="fl">2</span>, <span class="kw">col</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"blue2"</span>,<span class="st">"orange"</span>), <span class="kw">each</span> <span class="kw">=</span> <span class="fl">100</span>))</pre></body></html></div>
<p><img src="Week9_vignette_files/figure-html/unnamed-chunk-12-1.png" width="700"></p>
<p>Look at the PC Map</p>
<div class="sourceCode" id="cb17"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/graphics/par.html">par</a></span>(<span class="kw">mar</span><span class="kw">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">4</span>,<span class="fl">4</span>,<span class="fl">0.5</span>,<span class="fl">0.5</span>))
<span class="no">fit</span>  <span class="kw">&lt;-</span> <span class="kw pkg">fields</span><span class="kw ns">::</span><span class="fu"><a href="https://rdrr.io/pkg/fields/man/Krig.html">Krig</a></span>(<span class="no">res</span>, <span class="no">pcA</span>$<span class="no">x</span>[,<span class="fl">1</span>], <span class="kw">m</span><span class="kw">=</span><span class="fl">1</span>)</pre></body></html></div>
<pre><code>## Warning: 
## Grid searches over lambda (nugget and sill variances) with  minima at the endpoints: 
##   (REML) Restricted maximum likelihood 
##    minimum at  right endpoint  lambda  =  0.05291003 (eff. df= 190 )</code></pre>
<div class="sourceCode" id="cb19"><html><body><pre class="r"><span class="kw pkg">fields</span><span class="kw ns">::</span><span class="fu"><a href="https://rdrr.io/pkg/fields/man/fields-internal.html">surface</a></span>(<span class="no">fit</span>)
<span class="fu"><a href="https://rdrr.io/r/graphics/points.html">points</a></span>(<span class="no">res</span>)</pre></body></html></div>
<p><img src="Week9_vignette_files/figure-html/unnamed-chunk-13-1.png" width="672"></p>
<p><strong>Question 3:</strong> How does admixture change our prediction of population structure (PCA plot)? Is genomic ancestry correlated with geographical location?</p>
<p>To answer this latter part, check the R2 and significance of statistical association between PC1 component scores and geographical position (p1):</p>
<div class="sourceCode" id="cb20"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span>(<span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span>(<span class="no">pcA</span>$<span class="no">x</span>[,<span class="fl">1</span>]~ <span class="no">p1</span>))</pre></body></html></div>
<pre><code>## 
## Call:
## lm(formula = pcA$x[, 1] ~ p1)
## 
## Residuals:
##     Min      1Q  Median      3Q     Max 
## -3.6667 -0.7109 -0.0795  0.7629  2.5773 
## 
## Coefficients:
##             Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)   3.8364     0.1808   21.22   &lt;2e-16 ***
## p1           -7.6056     0.3238  -23.49   &lt;2e-16 ***
## ---
## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
## 
## Residual standard error: 1.097 on 198 degrees of freedom
## Multiple R-squared:  0.7359, Adjusted R-squared:  0.7346 
## F-statistic: 551.7 on 1 and 198 DF,  p-value: &lt; 2.2e-16</code></pre>
</div>
<div id="empirical-data-threespine-sticklebacks" class="section level2">
<h2 class="hasAnchor">
<a href="#empirical-data-threespine-sticklebacks" class="anchor"></a>4. Empirical data: Threespine sticklebacks</h2>
<p>The Threespine stickleback (Gasterosteus aculeatus) is a fish that has emerged as a model of rapid and parallel adaptation. Catchen et al. (2013) were interested in how populations colonize freshwater habitats in the Pacific Northwest, USA. These sticklebacks have diversified into three life history forms, one exclusively dwelling in the ocean, another being adapted to freshwater habitats, and one unusual population that can utilize both habitats. It was unclear if this one particular population (Riverbend), from a stream in central Oregon, was introduced due to unintentional human transport, and if this could be an example of rapid adaptation to freshwater from oceanic populations. Single nucleotide polymorphism data were generated using genotyping-by-sequencing, for 9 populations occupying coastal areas and inland streams.</p>
<div class="figure">
<img src="WE9_Fig2.png" alt="Map"><p class="caption">Map</p>
</div>
<p>In this tutorial, we will analyze the genetic data generated by Catchen et al. (2013) using a few exploratory methods to quantify and visualize genetic differentiation among the stickleback populations sampled. By the end of this tutorial, hopefully you will be able to make a convincing argument for the regional origin of the recently-introduced inland stickleback population.</p>
<div id="a-import-the-data" class="section level3">
<h3 class="hasAnchor">
<a href="#a-import-the-data" class="anchor"></a>a) Import the data:</h3>
<div class="sourceCode" id="cb22"><html><body><pre class="r"><span class="no">data</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/utils/read.table.html">read.table</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/system.file.html">system.file</a></span>(<span class="st">"extdata"</span>, <span class="st">"stickleback_data.txt"</span>, <span class="kw">package</span> <span class="kw">=</span> <span class="st">"LandGenCourse"</span>),
                   <span class="kw">sep</span><span class="kw">=</span><span class="st">"\t"</span>, <span class="kw">as.is</span><span class="kw">=</span><span class="no">T</span>, <span class="kw">check.names</span><span class="kw">=</span><span class="no">F</span>)</pre></body></html></div>
<p>Create a list of population IDs:</p>
<div class="sourceCode" id="cb23"><html><body><pre class="r"><span class="no">pops</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/unique.html">unique</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/unlist.html">unlist</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/lapply.html">lapply</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/colnames.html">rownames</a></span>(<span class="no">data</span>),
        <span class="kw">function</span>(<span class="no">x</span>){<span class="no">y</span><span class="kw">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>();<span class="no">y</span><span class="kw">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="no">y</span>,<span class="fu"><a href="https://rdrr.io/r/base/unlist.html">unlist</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/strsplit.html">strsplit</a></span>(<span class="no">x</span>,<span class="st">"_"</span>)<span class="kw">[[</span><span class="fl">1</span>]][<span class="fl">1</span>]))})))</pre></body></html></div>
<p>To understand the experimental design a bit better, let’s look at the sample size at each site.</p>
<div class="sourceCode" id="cb24"><html><body><pre class="r"><span class="no">sample_sites</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span>(<span class="fl">NA</span>,<span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span>(<span class="no">data</span>))
<span class="kw">for</span> (<span class="no">i</span> <span class="kw">in</span> <span class="fl">1</span>:<span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span>(<span class="no">data</span>)){
  <span class="no">sample_sites</span>[<span class="no">i</span>] <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/strsplit.html">strsplit</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/colnames.html">rownames</a></span>(<span class="no">data</span>),<span class="st">"_"</span>)<span class="kw">[[</span><span class="no">i</span>]][<span class="fl">1</span>]}
<span class="no">N</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/unlist.html">unlist</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/lapply.html">lapply</a></span>(<span class="no">pops</span>,<span class="kw">function</span>(<span class="no">x</span>){<span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/which.html">which</a></span>(<span class="no">sample_sites</span><span class="kw">==</span><span class="no">x</span>))}))
<span class="fu"><a href="https://rdrr.io/r/base/names.html">names</a></span>(<span class="no">N</span>) <span class="kw">&lt;-</span> <span class="no">pops</span>
<span class="no">N</span></pre></body></html></div>
<pre><code>##  cr  cs pcr  pl  sj stl  wc  rb  ms 
##  23  97  67  20  86  50  22 138  68</code></pre>
</div>
<div id="b-examine-population-structure-with-pca" class="section level3">
<h3 class="hasAnchor">
<a href="#b-examine-population-structure-with-pca" class="anchor"></a>b) Examine population structure with PCA</h3>
<p>Let’s start examining population structure, first using PCA. We’ll look at the amount of variation explained in the first few components, and then we’ll plot individuals for four components, coloring them by population.</p>
<div class="sourceCode" id="cb26"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/graphics/par.html">par</a></span>(<span class="kw">mar</span><span class="kw">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">4</span>,<span class="fl">4</span>,<span class="fl">2</span>,<span class="fl">0.5</span>))
<span class="no">pcaS</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/prcomp.html">prcomp</a></span>(<span class="no">data</span>,<span class="kw">center</span><span class="kw">=</span><span class="no">T</span>)
<span class="fu"><a href="https://rdrr.io/r/graphics/plot.html">plot</a></span>(<span class="no">pcaS</span>$<span class="no">sdev</span>^<span class="fl">2</span> / <span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span>(<span class="no">pcaS</span>$<span class="no">sdev</span>^<span class="fl">2</span>), <span class="kw">xlab</span><span class="kw">=</span><span class="st">"PC"</span>,
     <span class="kw">ylab</span><span class="kw">=</span><span class="st">"Fraction Variation Explained"</span>, <span class="kw">main</span><span class="kw">=</span><span class="st">"Scree plot"</span>)</pre></body></html></div>
<p><img src="Week9_vignette_files/figure-html/unnamed-chunk-18-1.png" width="700"></p>
<p>Get % variance explained for first few PCs:</p>
<div class="sourceCode" id="cb27"><html><body><pre class="r"><span class="no">perc</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span>(<span class="fl">100</span>*(<span class="no">pcaS</span>$<span class="no">sdev</span>^<span class="fl">2</span> / <span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span>(<span class="no">pcaS</span>$<span class="no">sdev</span>^<span class="fl">2</span>))[<span class="fl">1</span>:<span class="fl">10</span>],<span class="fl">2</span>)
<span class="fu"><a href="https://rdrr.io/r/base/names.html">names</a></span>(<span class="no">perc</span>) <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/apply.html">apply</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/array.html">array</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span>(<span class="fl">1</span>,<span class="fl">10</span>,<span class="fl">1</span>)), <span class="fl">1</span>, <span class="kw">function</span>(<span class="no">x</span>){<span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span>(<span class="st">"PC"</span>, <span class="no">x</span>)})
<span class="no">perc</span></pre></body></html></div>
<pre><code>##   PC1   PC2   PC3   PC4   PC5   PC6   PC7   PC8   PC9  PC10 
## 37.47  3.78  2.55  0.88  0.76  0.44  0.44  0.39  0.37  0.32</code></pre>
<p>Use the RColorBrewer package to select a color palette:</p>
<div class="sourceCode" id="cb29"><html><body><pre class="r"><span class="no">colors</span> <span class="kw">&lt;-</span> <span class="kw pkg">RColorBrewer</span><span class="kw ns">::</span><span class="fu"><a href="https://rdrr.io/pkg/RColorBrewer/man/ColorBrewer.html">brewer.pal</a></span>(<span class="fl">9</span>, <span class="st">"Paired"</span>)</pre></body></html></div>
<p>Plot first three PCs with colored symbols:</p>
<div class="sourceCode" id="cb30"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/graphics/par.html">par</a></span>(<span class="kw">mfrow</span><span class="kw">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">2</span>,<span class="fl">2</span>), <span class="kw">mar</span><span class="kw">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">4</span>,<span class="fl">4</span>,<span class="fl">0.5</span>,<span class="fl">0.5</span>))
<span class="fu"><a href="https://rdrr.io/r/graphics/plot.html">plot</a></span>(<span class="no">pcaS</span>$<span class="no">x</span>[,<span class="fl">1</span>:<span class="fl">2</span>], <span class="kw">col</span><span class="kw">=</span><span class="no">colors</span>[<span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span>(<span class="no">sample_sites</span>)], <span class="kw">pch</span><span class="kw">=</span><span class="fl">16</span>,<span class="kw">cex</span><span class="kw">=</span><span class="fl">1.2</span>)
<span class="fu"><a href="https://rdrr.io/r/graphics/legend.html">legend</a></span>(<span class="st">"bottomleft"</span>, <span class="kw">legend</span><span class="kw">=</span><span class="fu"><a href="https://rdrr.io/r/base/levels.html">levels</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span>(<span class="no">sample_sites</span>)),
       <span class="kw">col</span><span class="kw">=</span><span class="no">colors</span>, <span class="kw">pch</span><span class="kw">=</span><span class="fl">16</span>, <span class="kw">ncol</span><span class="kw">=</span><span class="fl">3</span>, <span class="kw">cex</span><span class="kw">=</span><span class="fl">0.8</span>)
<span class="fu"><a href="https://rdrr.io/r/graphics/plot.html">plot</a></span>(<span class="no">pcaS</span>$<span class="no">x</span>[,<span class="fl">2</span>:<span class="fl">3</span>], <span class="kw">col</span><span class="kw">=</span><span class="no">colors</span>[<span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span>(<span class="no">sample_sites</span>)], <span class="kw">pch</span><span class="kw">=</span><span class="fl">16</span>, <span class="kw">cex</span><span class="kw">=</span><span class="fl">1.2</span>)
<span class="fu"><a href="https://rdrr.io/r/graphics/plot.html">plot</a></span>(<span class="no">pcaS</span>$<span class="no">x</span>[,<span class="fl">3</span>:<span class="fl">4</span>], <span class="kw">col</span><span class="kw">=</span><span class="no">colors</span>[<span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span>(<span class="no">sample_sites</span>)], <span class="kw">pch</span><span class="kw">=</span><span class="fl">16</span>, <span class="kw">cex</span><span class="kw">=</span><span class="fl">1.2</span>)</pre></body></html></div>
<p><img src="Week9_vignette_files/figure-html/unnamed-chunk-21-1.png" width="672"></p>
<p><strong>Question 4:</strong></p>
<ul>
<li>Do you see evidence of population structure?</li>
<li>Is the number of components (here 4) a good representation of the number of populations?</li>
</ul>
</div>
<div id="c-clustering-with-snmf-similar-to-structure" class="section level3">
<h3 class="hasAnchor">
<a href="#c-clustering-with-snmf-similar-to-structure" class="anchor"></a>c) Clustering with SNMF (similar to ‘STRUCTURE’)</h3>
<p>Now we are going to use a clustering method to examine population structure. There are many approaches, with various assumptions, and it is important to consider the underlying biology of your research organism (and your dataset size) before choosing an appropriate method.</p>
<p>Here, we will use sparse negative matrix factorization (SNMF) because it is fast to compute for large datasets and it approximates the results of the well-known STRUCTURE algorithm. Notably, it relaxes population genetic assumptions such as Hardy-Weinberg proportions, so it may not converge on the same results as other programs.</p>
<p>We can use SNMF to estimate the number of genetic clusters (K) among our sampled populations. However, this may take a long time. If you want to run the analysis, un-comment the lines by removing the ‘#’ symbol at the beginning of each line.</p>
<p>We use SNMF’s cross-entropy criterion to infer the best estimate of K. The lower the cross-entropy, the better our model accounts for population structure. Sometimes cross-entropy continues to decline, so we might choose K where cross entropy first decreases the most.</p>
<div class="sourceCode" id="cb31"><html><body><pre class="r">#snmf2 &lt;- LEA::snmf(paste0(here::here(), "/data/stickleback.geno"), 
#                   K=1:8, ploidy=2, entropy=T, alpha=100, project="new")
#snmf2 &lt;- LEA::snmf("stickleback.geno", K=1:8, ploidy=2, entropy=T, 
#                   alpha=100, project="new")
#par(mfrow=c(1,1))
#plot(snmf2, col="blue4", cex=1.4, pch=19)</pre></body></html></div>
<p>INSERT FIGURE WITH RESULT?</p>
<p>The number of clusters is hard to determine, but four seems to be important and is similar to the results revealed by PCA. I will proceed assuming K=4. We will rerun SNMF using this setting.</p>
<div class="sourceCode" id="cb32"><html><body><pre class="r"><span class="no">K</span><span class="kw">=</span><span class="fl">4</span>
<span class="no">snmf</span> <span class="kw">=</span> <span class="kw pkg">LEA</span><span class="kw ns">::</span><span class="fu"><a href="https://rdrr.io/pkg/LEA/man/main_sNMF.html">snmf</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/system.file.html">system.file</a></span>(<span class="st">"extdata"</span>, <span class="st">"stickleback.geno"</span>, <span class="kw">package</span> <span class="kw">=</span> <span class="st">"LandGenCourse"</span>),
                 <span class="kw">K</span> <span class="kw">=</span> <span class="no">K</span>, <span class="kw">alpha</span> <span class="kw">=</span> <span class="fl">100</span>, <span class="kw">project</span> <span class="kw">=</span> <span class="st">"new"</span>)</pre></body></html></div>
<pre><code>## The project is saved into :
##  DUn/temp_libpath2c3f6a792c50/LandGenCourse/extdata/stickleback.snmfProject 
## 
## To load the project, use:
##  project = load.snmfProject("DUn/temp_libpath2c3f6a792c50/LandGenCourse/extdata/stickleback.snmfProject")
## 
## To remove the project, use:
##  remove.snmfProject("DUn/temp_libpath2c3f6a792c50/LandGenCourse/extdata/stickleback.snmfProject")
## 
## [1] "*************************************"
## [1] "* sNMF K = 4  repetition 1      *"
## [1] "*************************************"
## summary of the options:
## 
##         -n (number of individuals)             571
##         -L (number of loci)                    10000
##         -K (number of ancestral pops)          4
##         -x (input file)                        /private/var/folders/kz/fv8pzy0d3cl_mp3md294cvbh0000gn/T/RtmpwBqDUn/temp_libpath2c3f6a792c50/LandGenCourse/extdata/stickleback.geno
##         -q (individual admixture file)         /private/var/folders/kz/fv8pzy0d3cl_mp3md294cvbh0000gn/T/RtmpwBqDUn/temp_libpath2c3f6a792c50/LandGenCourse/extdata/stickleback.snmf/K4/run1/stickleback_r1.4.Q
##         -g (ancestral frequencies file)        /private/var/folders/kz/fv8pzy0d3cl_mp3md294cvbh0000gn/T/RtmpwBqDUn/temp_libpath2c3f6a792c50/LandGenCourse/extdata/stickleback.snmf/K4/run1/stickleback_r1.4.G
##         -i (number max of iterations)          200
##         -a (regularization parameter)          100
##         -s (seed random init)                  140391043595086
##         -e (tolerance error)                   1E-05
##         -p (number of processes)               1
##         - diploid
## 
## Read genotype file /private/var/folders/kz/fv8pzy0d3cl_mp3md294cvbh0000gn/T/RtmpwBqDUn/temp_libpath2c3f6a792c50/LandGenCourse/extdata/stickleback.geno:      OK.
## 
## 
## Main algorithm:
##  [                                                                           ]
##  [============]
## Number of iterations: 33
## 
## Least-square error: 722698.119383
## Write individual ancestry coefficient file /private/var/folders/kz/fv8pzy0d3cl_mp3md294cvbh0000gn/T/RtmpwBqDUn/temp_libpath2c3f6a792c50/LandGenCourse/extdata/stickleback.snmf/K4/run1/stickleback_r1.4.Q:       OK.
## Write ancestral allele frequency coefficient file /private/var/folders/kz/fv8pzy0d3cl_mp3md294cvbh0000gn/T/RtmpwBqDUn/temp_libpath2c3f6a792c50/LandGenCourse/extdata/stickleback.snmf/K4/run1/stickleback_r1.4.G:    OK.
## 
## The project is saved into :
##  DUn/temp_libpath2c3f6a792c50/LandGenCourse/extdata/stickleback.snmfProject 
## 
## To load the project, use:
##  project = load.snmfProject("DUn/temp_libpath2c3f6a792c50/LandGenCourse/extdata/stickleback.snmfProject")
## 
## To remove the project, use:
##  remove.snmfProject("DUn/temp_libpath2c3f6a792c50/LandGenCourse/extdata/stickleback.snmfProject")</code></pre>
</div>
<div id="d-plot-ancestry-proportions" class="section level3">
<h3 class="hasAnchor">
<a href="#d-plot-ancestry-proportions" class="anchor"></a>d) Plot ancestry proportions</h3>
<p>Create matrix of ancestry proportions:</p>
<div class="sourceCode" id="cb34"><html><body><pre class="r"><span class="no">qmatrix</span> <span class="kw">=</span> <span class="kw pkg">LEA</span><span class="kw ns">::</span><span class="fu"><a href="https://rdrr.io/pkg/LEA/man/Q.html">Q</a></span>(<span class="no">snmf</span>, <span class="kw">K</span> <span class="kw">=</span> <span class="no">K</span>)</pre></body></html></div>
<p>Plot results with a barplot similar to that used to represent STRUCTURE results</p>
<div class="sourceCode" id="cb35"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/graphics/par.html">par</a></span>(<span class="kw">mar</span><span class="kw">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">4</span>,<span class="fl">4</span>,<span class="fl">0.5</span>,<span class="fl">0.5</span>))
<span class="fu"><a href="https://rdrr.io/r/graphics/barplot.html">barplot</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/t.html">t</a></span>(<span class="no">qmatrix</span>), <span class="kw">col</span><span class="kw">=</span><span class="kw pkg">RColorBrewer</span><span class="kw ns">::</span><span class="fu"><a href="https://rdrr.io/pkg/RColorBrewer/man/ColorBrewer.html">brewer.pal</a></span>(<span class="fl">9</span>,<span class="st">"Paired"</span>),
        <span class="kw">border</span><span class="kw">=</span><span class="fl">NA</span>, <span class="kw">space</span><span class="kw">=</span><span class="fl">0</span>, <span class="kw">xlab</span><span class="kw">=</span><span class="st">"Individuals"</span>,
        <span class="kw">ylab</span><span class="kw">=</span><span class="st">"Admixture coefficients"</span>)
<span class="co">#Add population labels to the axis:</span>
<span class="kw">for</span> (<span class="no">i</span> <span class="kw">in</span> <span class="fl">1</span>:<span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span>(<span class="no">pops</span>)){
  <span class="fu"><a href="https://rdrr.io/r/graphics/axis.html">axis</a></span>(<span class="fl">1</span>, <span class="kw">at</span><span class="kw">=</span><span class="fu"><a href="https://rdrr.io/r/stats/median.html">median</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/which.html">which</a></span>(<span class="no">sample_sites</span><span class="kw">==</span><span class="no">pops</span>[<span class="no">i</span>])), <span class="kw">labels</span><span class="kw">=</span><span class="no">pops</span>[<span class="no">i</span>])}</pre></body></html></div>
<p><img src="Week9_vignette_files/figure-html/unnamed-chunk-25-1.png" width="672"></p>
</div>
<div id="e-visualize-admixture-proportions-on-a-map" class="section level3">
<h3 class="hasAnchor">
<a href="#e-visualize-admixture-proportions-on-a-map" class="anchor"></a>e) Visualize admixture proportions on a map</h3>
<p>Import geographical coordinates for the populations:</p>
<div class="sourceCode" id="cb36"><html><body><pre class="r"><span class="no">sites</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/utils/read.table.html">read.csv</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/system.file.html">system.file</a></span>(<span class="st">"extdata"</span>, <span class="st">"stickleback_coordinates.csv"</span>,
                              <span class="kw">package</span> <span class="kw">=</span> <span class="st">"LandGenCourse"</span>), <span class="kw">as.is</span><span class="kw">=</span><span class="no">T</span>, <span class="kw">check.names</span><span class="kw">=</span><span class="no">F</span>, <span class="kw">h</span><span class="kw">=</span><span class="no">T</span>)</pre></body></html></div>
<p>Calculate population average ancestry proportions and create an array with population coordinates:</p>
<div class="sourceCode" id="cb37"><html><body><pre class="r"><span class="co">#initialize array for ancestry proportions:</span>
<span class="no">qpop</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span>(<span class="fl">NA</span>,<span class="kw">nrow</span><span class="kw">=</span><span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span>(<span class="no">pops</span>),<span class="kw">ncol</span><span class="kw">=</span><span class="no">K</span>)

<span class="co">#intialize array for coordinates:</span>
<span class="no">coord.pop</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span>(<span class="fl">NA</span>,<span class="kw">nrow</span><span class="kw">=</span><span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span>(<span class="no">pops</span>),<span class="kw">ncol</span><span class="kw">=</span><span class="fl">2</span>)
<span class="no">index</span><span class="kw">=</span><span class="fl">0</span>

<span class="kw">for</span> (<span class="no">i</span> <span class="kw">in</span> <span class="fl">1</span>:<span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span>(<span class="no">pops</span>)){
  <span class="kw">if</span> (<span class="no">i</span><span class="kw">==</span><span class="fl">1</span>){
    <span class="co"># input pop ancestry proportions for each K cluster:</span>
    <span class="no">qpop</span>[<span class="no">i</span>,] <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/apply.html">apply</a></span>(<span class="no">qmatrix</span>[<span class="fl">1</span>:<span class="no">N</span>[<span class="no">i</span>],], <span class="fl">2</span>, <span class="no">mean</span>)
    <span class="co">#input pop coordinates:</span>
    <span class="no">coord.pop</span>[<span class="no">i</span>,<span class="fl">1</span>] <span class="kw">&lt;-</span> <span class="no">sites</span>[<span class="fu"><a href="https://rdrr.io/r/base/which.html">which</a></span>(<span class="no">sites</span>[,<span class="fl">1</span>]<span class="kw">==</span><span class="fu"><a href="https://rdrr.io/r/base/names.html">names</a></span>(<span class="no">N</span>[<span class="no">i</span>])),<span class="fl">6</span>]
    <span class="co">#input pop coordinates:</span>
    <span class="no">coord.pop</span>[<span class="no">i</span>,<span class="fl">2</span>] <span class="kw">&lt;-</span> <span class="no">sites</span>[<span class="fu"><a href="https://rdrr.io/r/base/which.html">which</a></span>(<span class="no">sites</span>[,<span class="fl">1</span>]<span class="kw">==</span><span class="fu"><a href="https://rdrr.io/r/base/names.html">names</a></span>(<span class="no">N</span>[<span class="no">i</span>])),<span class="fl">5</span>]
    <span class="no">index</span> <span class="kw">=</span> <span class="no">index</span> + <span class="no">N</span>[<span class="no">i</span>]
  } <span class="kw">else</span> {
    <span class="no">qpop</span>[<span class="no">i</span>,] <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/apply.html">apply</a></span>(<span class="no">qmatrix</span>[(<span class="no">index</span>+<span class="fl">1</span>):(<span class="no">index</span>+<span class="no">N</span>[<span class="no">i</span>]),], <span class="fl">2</span>, <span class="no">mean</span>)
    <span class="no">coord.pop</span>[<span class="no">i</span>,<span class="fl">1</span>] <span class="kw">&lt;-</span> <span class="no">sites</span>[<span class="fu"><a href="https://rdrr.io/r/base/which.html">which</a></span>(<span class="no">sites</span>[,<span class="fl">1</span>]<span class="kw">==</span><span class="fu"><a href="https://rdrr.io/r/base/names.html">names</a></span>(<span class="no">N</span>[<span class="no">i</span>])),<span class="fl">6</span>]
    <span class="no">coord.pop</span>[<span class="no">i</span>,<span class="fl">2</span>] <span class="kw">&lt;-</span> <span class="no">sites</span>[<span class="fu"><a href="https://rdrr.io/r/base/which.html">which</a></span>(<span class="no">sites</span>[,<span class="fl">1</span>]<span class="kw">==</span><span class="fu"><a href="https://rdrr.io/r/base/names.html">names</a></span>(<span class="no">N</span>[<span class="no">i</span>])),<span class="fl">5</span>]
    <span class="no">index</span> <span class="kw">=</span> <span class="no">index</span> + <span class="no">N</span>[<span class="no">i</span>]
  }
}</pre></body></html></div>
<p>Create map with pie charts depicting ancestry proportions:</p>
<div class="sourceCode" id="cb38"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/graphics/par.html">par</a></span>(<span class="kw">mar</span><span class="kw">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">4</span>,<span class="fl">4</span>,<span class="fl">0.5</span>,<span class="fl">0.5</span>))
<span class="fu"><a href="https://rdrr.io/r/graphics/plot.html">plot</a></span>(<span class="no">coord.pop</span>, <span class="kw">xlab</span> <span class="kw">=</span> <span class="st">"Longitude"</span>, <span class="kw">ylab</span> <span class="kw">=</span> <span class="st">"Latitude"</span>, <span class="kw">type</span> <span class="kw">=</span> <span class="st">"n"</span>)
<span class="kw pkg">maps</span><span class="kw ns">::</span><span class="fu"><a href="https://rdrr.io/pkg/maps/man/map.html">map</a></span>(<span class="kw">database</span><span class="kw">=</span><span class="st">'state'</span>,<span class="kw">add</span> <span class="kw">=</span> <span class="no">T</span>, <span class="kw">col</span> <span class="kw">=</span> <span class="st">"grey90"</span>, <span class="kw">fill</span> <span class="kw">=</span> <span class="fl">TRUE</span>)
<span class="kw">for</span> (<span class="no">i</span> <span class="kw">in</span> <span class="fl">1</span>:<span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span>(<span class="no">pops</span>)){
  <span class="kw pkg">mapplots</span><span class="kw ns">::</span><span class="fu"><a href="https://rdrr.io/pkg/mapplots/man/add.pie.html">add.pie</a></span>(<span class="kw">z</span><span class="kw">=</span><span class="no">qpop</span>[<span class="no">i</span>,], <span class="kw">x</span><span class="kw">=</span><span class="no">coord.pop</span>[<span class="no">i</span>,<span class="fl">1</span>],
                    <span class="kw">y</span><span class="kw">=</span><span class="no">coord.pop</span>[<span class="no">i</span>,<span class="fl">2</span>], <span class="kw">labels</span><span class="kw">=</span><span class="st">""</span>,
                    <span class="kw">col</span><span class="kw">=</span><span class="kw pkg">RColorBrewer</span><span class="kw ns">::</span><span class="fu"><a href="https://rdrr.io/pkg/RColorBrewer/man/ColorBrewer.html">brewer.pal</a></span>(<span class="no">K</span>,<span class="st">"Paired"</span>),<span class="kw">radius</span><span class="kw">=</span><span class="fl">0.1</span>)
}</pre></body></html></div>
<p><img src="Week9_vignette_files/figure-html/unnamed-chunk-28-1.png" width="700"></p>
<p><strong>Question 5:</strong></p>
<ul>
<li>How does the pattern of clustering vary in space?</li>
<li>Is there evidence of population admixture?</li>
<li>How do you interpret this pattern biologically?</li>
</ul>
<p><strong>Question 6:</strong></p>
<ul>
<li>Based on the analyses done in this tutorial, where do you hypothesize the “Riverbend” (“rb”) population originated from?</li>
<li>What evidence supports your rationale?</li>
</ul>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p>Developed by <a href="http://sites.utm.utoronto.ca/wagnerlab/">Helene Wagner</a>.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.5.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
